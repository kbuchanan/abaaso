/**
 * abaaso
 *
 * @author Jason Mulligan <jason.mulligan@avoidwork.com>
 * @copyright 2013 Jason Mulligan
 * @license BSD-3 <https://raw.github.com/avoidwork/abaaso/master/LICENSE>
 * @link http://abaaso.com
 * @module abaaso
 * @version 3.7.1
 */
(function(e){var t,abaaso,r,n,i,o=e.document,s=e.location,a=e.navigator,u="undefined"!=typeof exports;void 0===e.abaaso&&(u&&(i=require("url"),r=require("http"),n=require("https"),"undefined"==typeof Storage&&(localStorage=require("localStorage")),"undefined"==typeof XMLHttpRequest&&(XMLHttpRequest=null)),abaaso=function(){"use strict";function DataStore(e){this.autosave=!1,this.callback=null,this.collections=[],this.crawled=!1,this.credentials=null,this.datalists=[],this.depth=0,this.events=!0,this.expires=null,this.headers={Accept:"application/json"},this.ignore=[],this.key=null,this.keys={},this.leafs=[],this.loaded=!1,this.maxDepth=0,this.parentNode=e,this.pointer=null,this.records=[],this.recursive=!1,this.retrieve=!1,this.source=null,this.total=0,this.views={},this.uri=null}function DataList(e,t,r){this.callback=null,this.element=e,this.emptyMsg="Nothing to display",this.filter=null,this.id=L.genId(),this.pageIndex=1,this.pageSize=null,this.pageRange=5,this.pagination="bottom",this.placeholder="",this.order="",this.template=r,this.total=0,this.sensitivity="ci",this.store=t,this.where=null}function Deferred(){var e=this;this.promise=O.factory(),this.onDone=[],this.onAlways=[],this.onFail=[],L.when(this.promise).then(function(t){p.each(e.onDone,function(e){e(t)}),p.each(e.onAlways,function(e){e(t)}),e.onAlways=[],e.onDone=[],e.onFail=[]},function(t){p.each(e.onFail,function(e){e(t)}),p.each(e.onAlways,function(e){e(t)}),e.onAlways=[],e.onDone=[],e.onFail=[]})}function DataListFilter(e,t,r,n){this.element=e,this.datalist=t,this.debounce=n,this.set(r),this.init()}function Promise(){this.children=[],this.error=[],this.fulfill=[],this.parentNode=null,this.outcome=null,this.state=O.state.pending}var t,c,l,d,h={android:/android/i,allow:/^allow$/i,allow_cors:/^access-control-allow-methods$/i,alphanum:/^[a-zA-Z0-9]+$/,auth:/\/\/(.*)\@/,blackberry:/blackberry/i,"boolean":/^(0|1|true|false)?$/,boolean_number_string:/boolean|number|string/,checked_disabled:/checked|disabled/i,chrome:/chrome/i,complete_loaded:/^(complete|loaded)$/i,del:/^del/,decimal:/^\d+.(\d+)/,desc:/\s*desc$/i,domain:/^[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:\/~\+#]*[\w\-\@?^=%&amp;\/~\+#])?/,down:/down/,down_up:/down|up/,email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,element_update:/innerHTML|innerText|textContent|type|src/,firefox:/firefox/i,get_headers:/^(head|get|options)$/,get_remove_set:/get|remove|set/,hash:/\#/,header_replace:/:.*/,header_value_replace:/.*:\s+/,http_body:/200|202|203|206/,http_ports:/80|443/,ie:/msie|ie/i,input_button:/button|submit|reset/,integer:/(^-?\d\d*$)/,ip:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,is_xml:/<[^>]+>[^<]*]+>/,ios:/ipad|iphone/i,json_maybe:/json|plain|javascript/,json_wrap:/^[\[\{]/,jsonp_wrap:/([a-zA-Z0-9\.]+\()(.*)(\))$/,linux:/linux|bsd|unix/i,nil:/^null/i,no:/no/i,not_endpoint:/.*\//,notEmpty:/\w{1,}/,number:/(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)|number/,number_format_1:/.*\./,number_format_2:/\..*/,number_present:/\d{1,}/,number_string:/number|string/i,number_string_object:/number|object|string/i,null_undefined:/null|undefined/,observer_allowed:/click|error|key|mousedown|mouseup|submit/i,observer_globals:/body|document|window/i,object_undefined:/object|undefined/,opera:/opera/i,osx:/macintosh/i,patch:/^patch$/,phone:/^([0-9\(\)\/\+ \-\.]+)$/,playbook:/playbook/i,plural:/s$/,put_post:/^(post|put)$/i,radio_checkbox:/^(radio|checkbox)$/i,reflect:/function\s+\w*\s*\((.*?)\)/,root:/^\/[^\/]/,route_nget:/^(head|options)$/i,route_methods:/^(all|delete|get|put|post|head|options)$/i,safari:/safari/i,scheme:/.*\/\//,select:/select/i,selector_many:/\:|\./,selector_complex:/\s|\>/,sensitivity_types:/ci|cs|ms/,set_del:/^(set|del|delete)$/,sort_needle:/:::(.*)$/,space_hyphen:/\s|-/,string_boolean:/^(true|false)$/i,string_object:/string|object/i,string_true:/^true$/i,svg:/svg/,top_bottom:/top|bottom/i,true_undefined:/true|undefined/i,url:/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i,webos:/webos/i,windows:/windows/i,xml:/xml/i},p={add:function(e,t){return p.contains(e,t)||e.push(t),e},cast:function(){return u||!m.ie||m.version>8?function(e,t){t=t===!0;var r=[];return isNaN(e.length)?t?r=p.keys(e):L.iterate(e,function(e){r.push(e)}):r=Array.prototype.slice.call(e),r}:function(e,t){t=t===!0;var r=[];if(isNaN(e.length))t?r=p.keys(e):L.iterate(e,function(e){r.push(e)});else try{r=Array.prototype.slice.call(e)}catch(n){L.iterate(e,function(e,t){"length"!==t&&r.push(e)})}return r}},chunk:function(e,t){for(var r=[],n=N.round(e.length/t,"up"),i=0,o=-1;n>++o;)i=o*t,r.push(p.limit(e,i,t));return r},clear:function(e){return e.length>0?p.remove(e,0,e.length):e},clone:function(e){return L.clone(e)},contains:function(e,t){return p.index(e,t)>-1},collect:function(e,t){var r=[];return p.each(e,function(e){r.push(t(e))}),r},compact:function(e,t){var r=[];return r=e.filter(function(e){return!h.null_undefined.test(e)}),t?r.length<e.length?r:null:r},count:function(e,t){return e.filter(function(e){return e===t}).length},diff:function(e,t){var r=[];return p.each(e,function(e){p.contains(t,e)||p.add(r,e)}),p.each(t,function(t){p.contains(e,t)||p.add(r,t)}),r},each:function(e,t){for(var r=e.length,n=-1;r>++n&&t.call(e,e[n],n)!==!1;);return e},empty:function(e){return 0===e.length},equal:function(e,t){return k.encode(e)===k.encode(t)},fill:function(e,t,r,n){var i="function"==typeof t,o=e.length,s=isNaN(r)?0:r,a=isNaN(n)?o-1:s+n;for(a>o-1&&(a=o-1);a>=s;s++)e[s]=i?t(e[s]):t;return e},first:function(e){return e[0]},flat:function(e){var t=[];return t=e.reduce(function(e,t){return e.concat(t)},t)},index:function(e,t){return e.indexOf(t)},indexed:function(e){var t=[];return L.iterate(e,function(e){"object"==typeof e?t=t.concat(p.indexed(e)):t.push(e)}),t},intersect:function(e,t){var r=e.length>t.length?e:t,n=r===e?t:e;return r.filter(function(e){return p.contains(n,e)})},keep_if:function(e,t){if("function"!=typeof t)throw Error(_.error.invalidArguments);var r=[],n=[];return r=e.filter(t),n=p.diff(e,r),p.each(n,function(t){p.remove(e,p.index(e,t))}),e},keys:function(){return"function"==typeof Object.keys?function(e){return Object.keys(e)}:function(e){var t=[];return L.iterate(e,function(e,r){t.push(r)}),t}}(),last:function(e,t){var r=e.length-1;return t>=r+1?e:isNaN(t)||1===t?e[r]:p.limit(e,r- --t,r)},limit:function(e,t,r){var n=[],i=t-1,o=t+r,s=e.length;if(s>0)for(;o>++i&&s>i;)n.push(e[i]);return n},max:function(e){return p.last(e.sort(p.sort))},mean:function(e){return e.length>0?p.sum(e)/e.length:void 0},median:function(e){var t=e.length,r=N.round(t/2,"down"),n=e.sort(p.sort);return N.odd(t)?n[r]:(n[r-1]+n[r])/2},merge:function(e,t){return p.each(t,function(t){e.push(t)}),e},min:function(e){return e.sort(p.sort)[0]},mingle:function(e,t){var r;return r=e.map(function(e,r){return[e,t[r]]})},mode:function(e){var t,r={},n=0,i=0,o=[];return p.each(e,function(e){isNaN(r[e])?r[e]=1:++r[e]}),n=p.max(p.cast(r)),L.iterate(r,function(e,t){e===n&&o.push(N.parse(t))}),i=o.length,i>0&&(t=1===i?o[0]:o),t},range:function(e){return p.max(e)-p.min(e)},rassoc:function(e,t){var r;return p.each(e,function(n,i){return n[1]===t?(r=e[i],!1):void 0}),r},reject:function(e,t){return p.diff(e,e.filter(t))},replace:function(e,t){return p.remove(e,0,e.length),p.each(t,function(t){e.push(t)}),e},remove:function(e,t,r){if(isNaN(t)){if(t=e.index(t),-1===t)return e}else t=t||0;var n=e.length,i=e.slice((r||t)+1||n);return e.length=0>t?n+t:t,e.push.apply(e,i),e},remove_if:function(e,t){if("function"!=typeof t)throw Error(_.error.invalidArguments);var r=[];return r=e.filter(t),p.each(r,function(t){p.remove(e,p.index(e,t))}),e},remove_while:function(e,t){if("function"!=typeof t)throw Error(_.error.invalidArguments);var r=[];return p.each(e,function(e){return t(e)===!1?!1:(r.push(e),void 0)}),p.each(r,function(t){p.remove(e,p.index(e,t))}),e},rest:function(e,t){return t=t||1,1>t&&(t=1),p.limit(e,t,e.length)},rindex:function(e,t){var r=-1;return p.each(e,function(e,n){e===t&&(r=n)}),r},rotate:function(e,t){var r=[],n=e.length;return 0===t?r=e:(0>t?t+=n:t--,r=p.limit(e,t,n),r=r.concat(p.limit(e,0,t))),r},series:function(e,t,r){e=e||0,t=t||e,r=r||1;for(var n=[],i=-1,o=Math.max(0,Math.ceil((t-e)/r));o>++i;)n[i]=e,e+=r;return n},split:function(e,t){var r=[],n=e.length,i=Math.ceil(n/t),o=Math.floor(n/t),s=Math.ceil(n/i),a=!1,u=0,c=-1;for(N.diff(n,t*i)>i&&(s=n-o*t+o-1);t>++c;)!a&&t>s&&c===s&&(--i,a=!0),c>0&&(u+=i),r.push(p.limit(e,u,i));return r},sort:function(e,t){var r=!1,n=0;return isNaN(e)||isNaN(t)||(r=!0),e=r?N.parse(e):""+e,t=r?N.parse(t):""+t,t>e?n=-1:e>t&&(n=1),n},sum:function(e){var t=0;return e.length>0&&(t=e.reduce(function(e,t){return e+t})),t},take:function(e,t){return p.limit(e,0,t)},total:function(e){return p.indexed(e).length},toObject:function(e){for(var t={},r=e.length;r--;)t[""+r]=e[r];return t},unique:function(e){var t=[];return p.each(e,function(e){p.add(t,e)}),t},zip:function(e,t){var r=[];return t instanceof Array||(t="object"==typeof t?p.cast(t):[t]),p.each(t,function(e,t){e instanceof Array||(this[t]=[e])}),p.each(e,function(e,n){r[n]=[e],p.each(t,function(e){r[n].push(e[n]||null)})}),r}},v={items:{},clean:function(){return L.iterate(v.items,function(e,t){v.expired(t)&&v.expire(t)})},expire:function(e,t){return t=t===!0,void 0!==v.items[e]?(delete v.items[e],t||C.fire(e,"beforeExpire, expire, afterExpire"),!0):!1},expired:function(e){var t=v.items[e];return void 0!==t&&void 0!==t.expires&&t.expires<new Date},get:function(e,t){return e=L.parse(e).href,t=t!==!1,void 0===v.items[e]?!1:t&&v.expired(e)?(v.expire(e),!1):L.clone(v.items[e])},set:function(e,t,r){return e=L.parse(e).href,void 0===v.items[e]&&(v.items[e]={},v.items[e].permission=0),"permission"===t?v.items[e].permission|=r:"!permission"===t?v.items[e].permission&=~r:v.items[e][t]=r,v.items[e]}},m={activex:function(){var e=!1;if("undefined"!=typeof ActiveXObject)try{new ActiveXObject("Microsoft.XMLHTTP"),e=!0}catch(t){}return e}(),android:function(){return!u&&h.android.test(a.userAgent)}(),blackberry:function(){return!u&&h.blackberry.test(a.userAgent)}(),chrome:function(){return!u&&h.chrome.test(a.userAgent)}(),firefox:function(){return!u&&h.firefox.test(a.userAgent)}(),ie:function(){return!u&&h.ie.test(a.userAgent)}(),ios:function(){return!u&&h.ios.test(a.userAgent)}(),linux:function(){return!u&&h.linux.test(a.userAgent)}(),mobile:function(){return!u&&(/blackberry|iphone|webos/i.test(a.userAgent)||h.android.test(a.userAgent)&&(720>this.client.size.height||720>this.client.size.width))},playbook:function(){return!u&&h.playbook.test(a.userAgent)}(),opera:function(){return!u&&h.opera.test(a.userAgent)}(),osx:function(){return!u&&h.osx.test(a.userAgent)}(),safari:function(){return!u&&h.safari.test(a.userAgent.replace(/chrome.*/i,""))}(),tablet:function(){return!u&&(/ipad|playbook|webos/i.test(a.userAgent)||h.android.test(a.userAgent)&&(this.client.size.width>=720||this.client.size.width>=720))},webos:function(){return!u&&h.webos.test(a.userAgent)}(),windows:function(){return!u&&h.windows.test(a.userAgent)}(),version:function(){var e=0;switch(!0){case this.chrome:e=a.userAgent.replace(/(.*chrome\/|safari.*)/gi,"");break;case this.firefox:e=a.userAgent.replace(/(.*firefox\/)/gi,"");break;case this.ie:e=N.parse(a.userAgent.replace(/(.*msie|;.*)/gi,""),10),e>o.documentMode&&(e=o.documentMode);break;case this.opera:e=a.userAgent.replace(/(.*version\/|\(.*)/gi,"");break;case this.safari:e=a.userAgent.replace(/(.*version\/|safari.*)/gi,"");break;default:e=void 0!==a?a.appVersion:0}return e=N.parse(D.trim(e)),isNaN(e)&&(e=0),e},allows:function(e,t){if(D.isEmpty(e)||D.isEmpty(t))throw Error(_.error.invalidArguments);e=L.parse(e).href,t=t.toLowerCase();var r=!1,n=0;return v.get(e,!1)?(h.del.test(t)?n=1:h.get_headers.test(t)?n=4:h.put_post.test(t)?n=2:h.patch.test(t)&&(n=8),r=Boolean(m.permissions(e,t).bit&n)):r=void 0,r},bit:function(e){var t=0;return p.each(e,function(e){switch(e.toLowerCase()){case"head":case"get":case"options":t|=4;break;case"post":case"put":t|=2;break;case"patch":t|=8;break;case"delete":t|=1}}),t},cors:function(e){return!u&&e.indexOf("//")>-1&&-1===e.indexOf("//"+s.host)},headers:function(e,r,n){var i=D.trim(e.getAllResponseHeaders()).split("\n"),o={},s={},a=null,u=new Date,c=m.cors(r);switch(p.each(i,function(e){var t,r;r=e.replace(h.header_value_replace,""),t=e.replace(h.header_replace,""),t=D.unhyphenate(t,!0).replace(/\s+/g,"-"),o[t]=r,null===a&&(!c&&h.allow.test(t)||c&&h.allow_cors.test(t))&&(a=r)}),!0){case h.no.test(o["Cache-Control"]):case h.no.test(o.Pragma):break;case void 0!==o["Cache-Control"]&&h.number_present.test(o["Cache-Control"]):u=u.setSeconds(u.getSeconds()+N.parse(h.number_present.exec(o["Cache-Control"])[0],10));break;case void 0!==o.Expires:u=new Date(o.Expires);break;default:u=u.setSeconds(u.getSeconds()+t.expires)}return s.expires=u,s.headers=o,s.permission=m.bit(null!==a?D.explode(a):[n]),"get"===n&&(v.set(r,"expires",s.expires),v.set(r,"headers",s.headers),v.set(r,"permission",s.permission)),s},parse:function(e,t){t=t||"";var r,n;switch(!0){case(h.json_maybe.test(t)||D.isEmpty(t))&&h.json_wrap.test(e.responseText)&&Boolean(n=k.decode(e.responseText,!0)):case(h.json_maybe.test(t)||D.isEmpty(t))&&(n=h.jsonp_wrap.exec(e.responseText))&&null!==n&&Boolean(n=k.decode(n[2],!0)):r=n;break;case h.xml.test(t)&&D.isEmpty(e.responseText)&&void 0!==e.responseXML&&null!==e.responseXML:r=M.decode(void 0!==e.responseXML.xml?e.responseXML.xml:e.responseXML);break;case h.is_xml.test(e.responseText):r=M.decode(e.responseText);break;default:r=e.responseText}return r},permissions:function(e){var t=v.get(e,!1),r=t?t.permission:0,n={allows:[],bit:r,map:{partial:8,read:4,write:2,"delete":1,unknown:0}};return 1&r&&n.allows.push("DELETE"),2&r&&(n.allows.push("POST"),n.allows.push("PUT")),4&r&&n.allows.push("GET"),8&r&&n.allows.push("PATCH"),n},jsonp:function(r,n,i,o){var s,a,u,c=O.factory();switch(void 0===d&&(void 0===e.abaaso&&L.define("abaaso.callback",{},e),d="abaaso"),!0){case void 0===o:case null===o:case o instanceof Object&&(null===o.callback||void 0===o.callback):case"string"==typeof o&&D.isEmpty(o):s="callback";break;case o instanceof Object&&void 0!==o.callback:s=o.callback;break;default:s="callback"}c.then(function(e){"function"==typeof n&&n(e)},function(e){throw"function"==typeof i&&i(e),e});do a=L.genId().slice(0,10);while(void 0!==e.abaaso.callback[a]);return r=r.replace(s+"=?",s+"="+d+".callback."+a),e.abaaso.callback[a]=function(t){clearTimeout(L.timer[a]),delete L.timer[a],delete e.abaaso.callback[a],c.resolve(t),E.destroy(u)},u=E.create("script",{src:r,type:"text/javascript"},t("head")[0]),L.defer(function(){c.reject(void 0)},3e4,a),c},request:function(e,t,r,n,i,o,s){s=s||3e4;var a,c,l,d,f,p,y,g,b,w,E;if(h.put_post.test(t)&&void 0===i)throw Error(_.error.invalidArguments);if(e=L.parse(e).href,t=t.toLowerCase(),o=o instanceof Object?o:null,a=m.cors(e),c=m.ie&&10>m.version&&a?new XDomainRequest:!m.ie||m.version>8||"patch"!==t?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),l=(h.put_post.test(t)||h.patch.test(t))&&void 0!==i?i:null,d="get"===t?v.get(e):!1,f=t.capitalize(),p=null,y="undefined"!=typeof Document,g="undefined"!=typeof ArrayBuffer,b="undefined"!=typeof Blob,w=O.factory(),E=w.then(function(t){"function"==typeof r&&r.call(e,t,c),c=null},function(t){throw"function"==typeof n&&n.call(e,t,c),c=null,t}),e.fire("before"+f),!a&&!h.get_headers.test(t)&&m.allows(e,t)===!1)return c.status=405,w.reject(null),e.fire("failed"+f,null,c);if("get"===t&&Boolean(d))u&&(c.readyState=4,c.status=200,c._resheaders=d.headers),w.resolve(d.response),e.fire("afterGet",d.response,c);else{c[c.onreadystatechange!==void 0?"onreadystatechange":"onload"]=function(){m.response(c,e,t,w)};try{void 0!==c.timeout&&(c.timeout=s)}catch(x){}void 0!==c.ontimeout&&(c.ontimeout=function(t){e.fire("timeout"+f,t,c)}),void 0!==c.onprogress&&(c.onprogress=function(t){e.fire("progress"+f,t,c)}),void 0!==c.upload&&void 0!==c.upload.onprogress&&(c.upload.onprogress=function(t){e.fire("progressUpload"+f,t,c)}),c.open(t.toUpperCase(),e,!0),null!==o&&o.hasOwnProperty("Content-Type")&&(p=o["Content-Type"]),a&&null===p&&(p="text/plain"),null!==l&&(l.hasOwnProperty("xml")&&(l=l.xml),y&&l instanceof Document&&(l=M.decode(l)),"string"==typeof l&&h.is_xml.test(l)&&(p="application/xml"),g&&l instanceof ArrayBuffer||b&&l instanceof Blob||!(l instanceof Object)||(p="application/json",l=k.encode(l)),null===p&&(g&&l instanceof ArrayBuffer||b&&l instanceof Blob)&&(p="application/octet-stream"),null===p&&(p="application/x-www-form-urlencoded; charset=UTF-8")),c.setRequestHeader!==void 0&&("object"==typeof d&&d.headers.hasOwnProperty("ETag")&&c.setRequestHeader("ETag",d.headers.ETag),null===o&&(o={}),null!==p&&(o["Content-Type"]=p),o.hasOwnProperty("callback")&&delete o.callback,L.iterate(o,function(e,t){null!==e&&"withCredentials"!==t&&c.setRequestHeader(t,e)})),"boolean"==typeof c.withCredentials&&null!==o&&"boolean"==typeof o.withCredentials&&(c.withCredentials=o.withCredentials),null!==l?c.send(l):c.send()}return E},response:function(e,t,r,n){var i,o,s,a,c,d=D.capitalize(r.toLowerCase()),f=null,p=m.ie&&void 0===e.readyState;if(i=function(e,r){n.reject(e),l(e,arguments,this,!0),t.fire("failed"+d,m.parse(r),r)},p||2!==e.readyState)if(p||4!==e.readyState)p&&(s=m.parse(e),v.set(t,"permission",m.bit(["get"])),v.set(t,"response",s),n.resolve(s),t.fire("afterGet",s,e));else{switch(e.status){case 200:case 201:case 202:case 203:case 204:case 205:case 206:if(o=m.headers(e,t,r),t.fire("headers",o.headers,e),"head"===r)return n.resolve(o.headers),t.fire("afterHead",o.headers);if("options"===r)return n.resolve(o.headers),t.fire("afterOptions",o.headers);if("delete"!==r){if(h.http_body.test(e.status)&&(a=o.headers["Content-Type"]||"",s=m.parse(e,a),void 0===s))throw Error(_.error.serverError);"get"===r?v.set(t,"response",o.response=L.clone(s)):v.expire(t,!0)}else"delete"===r&&v.expire(t,!0);switch(null!==T.getHeader()&&Boolean(f=o.headers[T.getHeader()])&&T.current!==f&&T.setCurrent(T),e.status){case 200:case 202:case 203:case 206:n.resolve(s),t.fire("after"+d,s,e);break;case 201:if(void 0!==o.headers.Location&&!D.isEmpty(o.headers.Location)||D.isUrl(s)){c=D.trim(o.headers.Location||s),m.request(c,"GET",function(r){n.resolve(r),t.fire("after"+d,r,e)},function(t){i(t,e)});break}i(Error(_.error.invalidArguments),e);case 204:n.resolve(null),t.fire("after"+d,null,e);break;case 205:n.resolve(null),t.fire("reset",null,e)}break;case 401:i(u?_.error.serverUnauthorized:Error(_.error.serverUnauthorized),e);break;case 403:v.set(t,"!permission",m.bit([r])),i(u?_.error.serverForbidden:Error(_.error.serverForbidden),e);break;case 405:v.set(t,"!permission",m.bit([r])),i(u?_.error.serverInvalidMethod:Error(_.error.serverInvalidMethod),e);break;default:i(u?_.error.serverError:Error(_.error.serverError),e)}try{e.onreadystatechange=null}catch(y){}}else t.fire("received"+d,null,e)},size:function(){var e=u?{clientHeight:0,clientWidth:0}:void 0!==o.documentElement?o.documentElement:o.body;return{height:e.clientHeight,width:e.clientWidth}}},y={expire:function(e,t,r){return void 0!==y.get(e)&&y.set(e,"","-1s",t,r),e},get:function(e){return L.coerce(y.list()[e])},list:function(){var e={};return void 0===o.cookie||D.isEmpty(o.cookie)||p.each(D.explode(o.cookie,";"),function(t){var r=D.explode(t,"=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}),e},set:function(e,t,r,n,i){t=(t||"")+";",r=r||"",n="string"==typeof n?" domain="+n+";":"",i=i===!0?"; secure":"";var s="",a=null,u=null,c=["d","h","m","s"],l=RegExp(),d=c.length;if(!D.isEmpty(r)){for(;d--;)if(L.compile(l,c[d]),l.test(r)){u=c[d],a=N.parse(r,10);break}if(isNaN(a))throw Error(_.error.invalidArguments);switch(s=new Date,u){case"d":s.setDate(s.getDate()+a);break;case"h":s.setHours(s.getHours()+a);break;case"m":s.setMinutes(s.getMinutes()+a);break;case"s":s.setSeconds(s.getSeconds()+a)}}return s instanceof Date&&(s=" expires="+s.toUTCString()+";"),o.cookie=D.trim(""+e)+"="+t+s+n+" path=/"+i,y.get(e)}},g={decorator:function(e,t,r){return e=L.object(e),L.genId(e),"function"!=typeof e.fire&&C.decorate(e),e.data=new DataStore(e),r instanceof Object&&L.merge(e.data,r),null!==t&&"object"==typeof t&&e.data.batch("set",t),e},methods:{batch:function(e,t,r,n){if(e=(""+e).toLowerCase(),r=r===!0,n=n||1e3,!h.set_del.test(e)||r&&h.del.test(e)||"object"!=typeof t)throw Error(_.error.invalidArguments);var i,o,s,a,u,c,l=this,d=this.events===!0,f=0,v=t.length,y=!1,g=O.factory();return o=g.then(function(t){l.loaded=!0,h.del.test(e)&&l.reindex(),l.autosave&&l.save(),p.each(l.datalists,function(e){e.refresh(!0)}),d&&C.fire(l.parentNode,"afterDataBatch",t)},function(e){throw d&&C.fire(l.parentNode,"failedDataBatch",e),e}),i=function(e){g.resolve(e)},s=function(e){g.reject(e)},a=function(e,t){var r=L.clone(e),n=O.factory(),o={};"function"!=typeof r.batch?o=r:L.iterate(r,function(e,t){p.contains(l.collections,t)||(o[t]=e)}),null!==l.key&&void 0!==o[l.key]&&(t=o[l.key],delete o[l.key]),n.then(function(){++f===v&&i(l.records)},function(e){y||(y=!0,s(e))}),o instanceof Array&&null!==l.uri?l.generate(t,void 0).then(function(e){n.resolve(e)},function(e){n.reject(e)}):l.set(t,o,!0).then(function(e){n.resolve(e)},function(e){n.reject(e)})},u=function(e){var t=O.factory();t.then(function(e){return++f===v&&i(e),e},function(e){return y||(y=!0,s(e)),e}),l.del(e,!1,!0).then(function(e){t.resolve(e)},function(e){t.reject(e)})},d&&C.fire(l.parentNode,"beforeDataBatch",t),r&&this.clear(r),0===t.length?i([]):"set"===e?p.each(p.chunk(t,n),function(e,t){L.defer(function(){var t;p.each(e,function(e,r){if((p.contains(l.ignore,e)||p.contains(l.leafs,e))&&(t=e,e={}),"object"==typeof e)a(e,t||L.uuid());else if(-1===e.indexOf("//")){if("/"!==e.charAt(0)?e=l.uri+"/"+e:null!==l.uri&&h.root.test(e)&&(c=L.parse(l.uri),e=c.protocol+"//"+c.host+e),r=e.replace(h.not_endpoint,""),D.isEmpty(r))return;m.request(e,"GET",function(e){a(null===l.source?e:L.walk(e,l.source),r)},s,L.merge({withCredentials:l.credentials},l.headers))}else{if(r=e.replace(h.not_endpoint,""),D.isEmpty(r))return;m.request(e,"GET",function(e){a(null===l.source?e:L.walk(e,l.source),r)},s,L.merge({withCredentials:l.credentials},l.headers))}})},t)}):p.each(t.sort(p.sort).reverse(),function(e){u(e)}),o},clear:function(e){e=e===!0;var t=this.events===!0;return e?(this.collections=[],this.crawled=!1,this.keys={},this.loaded=!1,this.records=[],this.total=0,this.views={},p.each(this.datalists,function(e){e.refresh(!0,!0)})):(t&&C.fire(this.parentNode,"beforeDataClear"),p.each(this.datalists,function(e){e.teardown(!0)}),this.autosave=!1,this.callback=null,this.collections=[],this.crawled=!1,this.credentials=null,this.datalists=[],this.depth=0,this.events=!0,this.expires=null,this.headers={Accept:"application/json"},this.ignore=[],this.key=null,this.keys={},this.leafs=[],this.loaded=!1,this.maxDepth=0,this.pointer=null,this.records=[],this.recursive=!1,this.retrieve=!1,this.source=null,this.total=0,this.views={},this.uri=null,t&&C.fire(this.parentNode,"afterDataClear")),this},crawl:function(e){var t,r,n,i,o=this,s=this.events===!0,a=e instanceof Object?e:this.get(e),u=null===this.uri?"":this.uri,c=O.factory(),l=0,d=0;if(void 0===a)throw Error(_.error.invalidArguments);return this.crawled=!0,n=c.then(function(e){return e}),t=function(e,t){var r,n="";return/\/\//.test(e)?n=e:"/"===e.charAt(0)&&"/"!==t.charAt(0)?(r=L.parse(t),n=r.protocol+"//"+r.host+e):n=e,n},r=function(){++l===d&&c.resolve(d)},i=function(e,t){var r={};return p.contains(t.collections,e)||t.collections.push(e),r=g.decorator({id:a.key+"-"+e},null,{key:t.key,pointer:t.pointer,source:t.source,ignore:L.clone(t.ignore),leafs:L.clone(t.leafs),depth:t.depth+1,maxDepth:t.maxDepth}),r.data.headers=L.merge(r.data.headers,t.headers),!p.contains(t.leafs,e)&&t.recursive&&t.retrieve&&(0===r.data.maxDepth||r.data.depth<r.data.maxDepth)&&(r.data.recursive=!0,r.data.retrieve=!0),r},L.iterate(a.data,function(e,n){var c;p.contains(o.ignore,n)||p.contains(o.leafs,n)||o.depth>=o.maxDepth||!(e instanceof Array||"string"==typeof e)||(d=p.cast(a.data).length,c=O.factory(),c.then(function(e){s&&C.fire(a.data[n],"afterDataRetrieve",e),r()},function(e){s&&C.fire(a.data[n],"failedDataRetrieve",e),r()}),e instanceof Array&&e.length>0?(a.data[n]=i(n,o),"string"==typeof e[0]&&p.each(e,function(r,n){e[n]=t(r,u)}),a.data[n].data.batch("set",e,!0,void 0).then(function(e){c.resolve(e)},function(e){c.reject(e)})):("/"===e.charAt(0)||e.indexOf("//")>-1)&&(a.data[n]=i(n,o),e=t(e,u),a.data[n].data.setUri(e).then(function(e){c.resolve(e)},function(e){c.reject(e)})))}),n},del:function(e,t,r){if(void 0===e||!h.number_string.test(typeof e))throw Error(_.error.invalidArguments);t=t!==!1,r=r===!0;var n,i,o,s,a,u=this,c=this.events===!0,l=O.factory();if(n=l.then(function(e){var t=u.get(e.record);u.records.remove(u.keys[e.key]),delete u.keys[e.key],u.total--,u.views={},L.iterate(t.data,function(e){null!==e&&void 0!==e.data&&"function"==typeof e.data.teardown&&e.data.teardown()}),e.reindex&&u.reindex(),r||(u.autosave&&u.save(),p.each(u.datalists,function(e){e.del(t)})),c&&C.fire(u.parentNode,"afterDataDelete",t)},function(e){throw c&&C.fire(u.parentNode,"failedDataDelete",e),e}),"string"==typeof e){if(i=e,e=this.keys[i],void 0===e)throw Error(_.error.invalidArguments)}else{if(i=this.records[e],void 0===i)throw Error(_.error.invalidArguments);i=i.key}return o={key:i,record:e,reindex:t},r||null!==this.callback||null===this.uri||(s=this.uri+"/"+i,a=m.cors(s)||m.allows(s,"delete")),c&&C.fire(u.parentNode,"beforeDataDelete",o),r||null!==this.callback||null===this.uri?l.resolve(o):h.true_undefined.test(a)?m.request(s,"DELETE",function(){l.resolve(o)},function(e){l.reject(e)},L.merge({withCredentials:this.credentials},this.headers)):l.reject(o),n},find:function(e,t,r){if(void 0===e)throw Error(_.error.invalidArguments);var n=[],i=[],o=RegExp(),s="function"==typeof e;return 0===this.total?n:(s||(e="string"==typeof e?D.explode(e):[e],void 0===r||D.isEmpty(r)?r="gi":null===r&&(r="")),t="string"==typeof t?D.explode(t):null,null===t?p.each(this.records,function(t){s?e(t)===!0&&(i.push(t.key),n.push(t)):L.iterate(t.data,function(s){return p.contains(i,t.key)?!1:(null!==s&&"object"!=typeof s.data&&p.each(e,function(e){return L.compile(o,e,r),o.test(s)?(i.push(t.key),n.push(t),!1):void 0}),void 0)})}):p.each(this.records,function(a){p.each(t,function(t){if(p.contains(i,a.key))return!1;if(void 0!==a.data[t]&&"object"!=typeof a.data[t].data)if(s){if(e(a.data[t])===!0)return i.push(a.key),n.push(a),!1}else p.each(e,function(e){return L.compile(o,e,r),o.test(a.data[t])?(i.push(a.key),n.push(a),!1):void 0})})}),n)},form:function(e,r,n){n=n!==!1;var i,o,s,a,u,c,l=null===e,d=this;if(this.events===!0,l?e=this.get(0):e instanceof Object||(e=this.get(e)),void 0===e)throw Error(_.error.invalidArguments);if(null!==this.uri&&!m.cors(this.uri)&&!m.allows(this.uri,"post"))throw Error(_.error.serverInvalidMethod);return u=e.key,c=e.data,void 0!==r&&(r=L.object(r)),null!==this.uri?(i=this.uri.replace(h.not_endpoint,"").replace(/\?.*/,""),D.isDomain(i)&&(i=i.replace(/\..*/g,""))):i="record",s=function(e){var r=L.target(e).parentNode,i=t("#"+r.id+" input"),o=i[0].name.match(/(.*)\[/)[1],s=!0,a={};switch(L.stop(e),n&&(s=E.validate(r)),s){case!0:p.each(i,function(e){void 0!==e.type&&h.input_button.test(e.type)||L.define(e.name.replace("[",".").replace("]",""),e.value,a)}),d.set(u,a[o]).then(function(){E.destroy(r)},function(){E.destroy(r)})}},a=function(e,t,r){var n,i;L.iterate(e,function(e,o){e instanceof Array?(n=0,p.each(e,function(e){a(e,t,r+"["+o+"]["+n++ +"]")})):e instanceof Object?a(e,t,r+"["+o+"]"):(i=(r+"["+o+"]").replace(/\[|\]/g,""),t.create("label",{"for":i,innerHTML:D.capitalize(o)}),t.create("input",{id:i,name:r+"["+o+"]",type:"text",value:l?"":e}))})},o=E.create("form",{style:"display:none;"},r),a(c,o,i),C.add(E.create("input",{type:"button",value:_.common.submit},o),"click",function(e){s(e)}),E.create("input",{type:"reset",value:_.common.reset},o),E.css(o,"display","inherit"),o},generate:function(e,t){var r,n,i,o=this,s=O.factory(),a={},u=null;return a={depth:this.depth+1,headers:this.headers,ignore:p.clone(this.ignore),leafs:p.clone(this.leafs),key:this.key,maxDepth:this.maxDepth,pointer:this.pointer,recursive:this.recursive,retrieve:this.retrieve,source:this.source},r=s.then(function(e){return e},function(e){throw e}),n=function(){"object"==typeof t&&(u=t),(0===a.maxDepth||a.depth<=a.maxDepth)&&(o.records[i]=g.decorator({id:e},u,a),null===u&&(null===o.uri||void 0!==t||p.contains(o.leafs,e)||(t=o.uri+"/"+e),void 0!==t?o.records[i].data.setUri(t).then(function(e){s.resolve(e)},function(e){s.reject(e)}):s.resolve(o.records[i].data.records)))},void 0!==this.keys[e]?(i=this.keys[e],"function"==typeof this.records[i].data.teardown&&this.records[i].data.teardown(),n()):this.set(e,{},!0).then(function(e){i=o.keys[e.key],o.collections.add(e.key),n()}),r},get:function(e,t){var r,n=this.records,i=typeof e,o=this;return"undefined"===i||0===(""+e).length?r=n:"string"===i&&e.indexOf(",")>-1?(r=[],p.each(D.explode(e),function(e){isNaN(e)||(e=N.parse(e,10)),r.push(o.get(e))})):"string"===i&&void 0!==this.keys[e]?r=n[this.keys[e]]:"number"===i&&void 0===t?r=n[N.parse(e,10)]:"number"===i&&"number"==typeof t&&(r=n.limit(N.parse(e,10),N.parse(t,10))),r},purge:function(e){return this.storage(e||this,"remove")},reindex:function(){var e=this.total,t=-1;if(this.views={},e>0)for(;e>++t;)this.records[t].index=t,this.keys[this.records[t].key]=t;return this},restore:function(e){return this.storage(e||this,"get")},save:function(e){return this.storage(e||this,"set")},select:function(e){var t;if(!(e instanceof Object))throw Error(_.error.invalidArguments);return t=this.records.filter(function(t){var r=!0;return L.iterate(e,function(e,n){var i=typeof e;return"function"!==i&&t.data[n]!==e?r=!1:"function"!==i||e(t.data[n])?void 0:r=!1}),r})},set:function(e,t,r){r=r===!0;var n,i,o,s,a,u,c,l,d=this,f=O.factory(),v=!1;if(!(t instanceof Object))throw Error(_.error.invalidArguments);return i=f.then(function(e){var t,n,i={data:null,key:e.key,record:e.record,result:e.result},o=O.factory();if(i.data=L.clone(e.data),o.then(function(e){d.retrieve&&d.crawl(e),r||(d.autosave&&d.save(),p.each(d.datalists,function(e){e.refresh()})),a&&C.fire(d.parentNode,"afterDataSet",e)},function(e){throw a&&C.fire(d.parentNode,"failedDataSet",e),e}),d.views={},void 0!==i.key&&(i.record=d.get(i.key)),void 0===i.record){var s=d.total++;void 0===i.key&&(void 0===i.result&&(d.total--,o.reject(_.error.expectedObject)),null!==d.source&&(i.result=L.walk(i.result,d.source)),null===d.key?i.key=L.uuid():(i.key=i.result[d.key],delete i.result[d.key]),"string"!=typeof i.key&&(i.key=""+i.key),i.data=i.result),d.keys[i.key]=s,d.records[s]={key:i.key,data:{},index:s},t=d.records[s],null===d.pointer||void 0===i.data[d.pointer]?(t.data=i.data,null!==d.key&&t.data.hasOwnProperty(d.key)&&delete t.data[d.key],o.resolve(t)):(n=i.data[d.pointer],(void 0===n||null===n)&&(delete d.records[s],delete d.keys[i.key],o.reject(_.error.expectedObject)),t.data={},m.request(n,"GET",function(e){null!==d.source&&(e=L.walk(e,d.source)),void 0!==e[d.key]&&delete e[d.key],t.data=e,o.resolve(t)},function(e){o.reject(e)},d.headers))}else t=d.records[d.keys[i.record.key]],t.data=i.data,o.resolve(t);return t},function(e){throw a&&C.fire(d.parentNode,"failedDataSet",e),e}),e instanceof Object&&(r=t,t=e,e=null),n=L.clone(t),null===e&&null===this.uri?null===this.key||void 0===n[this.key]?e=L.uuid():(e=n[this.key],delete n[this.key]):null===e&&(e=void 0),n instanceof Array?this.generate(e).then(function(){d.get(e).data.batch("set",n).then(function(e){f.resolve(e)
},function(e){f.reject(e)})}):(o=void 0===e?void 0:this.get(e),s=void 0===e?"post":"put",a=this.events===!0,u={data:{},key:e,record:void 0},c=this.uri,r||null!==this.callback||null===c||(void 0!==o&&c.replace(h.not_endpoint,"")!==o.key&&(c+="/"+o.key),"put"===s&&m.allows(c,"patch")&&(!m.ie||m.version>8||m.activex)&&(s="patch",l=v=!0),void 0===l&&(l=m.cors(c)||m.allows(c,s))),void 0!==o?(u.record=this.records[this.keys[o.key]],L.iterate(u.record.data,function(e,t){p.contains(d.ignore,t)||(u.data[t]=e)}),L.merge(u.data,n),v||(n=u.data)):u.data=n,a&&C.fire(d.parentNode,"beforeDataSet",{key:e,data:n}),r||null!==this.callback||null===this.uri?f.resolve(u):h.true_undefined.test(l)?m.request(c,s.toUpperCase(),function(e){u.result=e,f.resolve(u)},function(e){f.reject(e)},n,L.merge({withCredentials:this.credentials},this.headers)):f.reject(u),i)},setExpires:function(e){if(null!==e&&null===this.uri||null!==e&&(isNaN(e)||1e3>e))throw Error(_.error.invalidArguments);if(this.expires!==e){this.expires=e;var t=this.parentNode.id+"DataExpire",r=e,n=this;L.clearTimers(t),null!==e&&L.repeat(function(){return null===n.uri?(n.setExpires(null),!1):(v.expire(n.uri)||C.fire(n.uri,"beforeExpire, expire, afterExpire"),void 0)},r,t,!1)}},setUri:function(e){var t,r=O.factory();if(null!==e&&D.isEmpty(e))throw Error(_.error.invalidArguments);return e=L.parse(e).href,this.uri===e?t=this.uri:(null!==this.uri&&C.remove(this.uri),t=this.uri=e,null!==t&&(C.add(t,"expire",function(){this.sync(!0)},"dataSync",this),v.expire(t,!0),this.sync(!0).then(function(e){r.resolve(e)},function(e){r.reject(e)}))),r},sort:function(e,t,r,n){if(void 0===e||D.isEmpty(e))throw Error(_.error.invalidArguments);h.sensitivity_types.test(r)||(r="ci"),t=t===!0;var i,o,s,a=e.replace(/\s*asc/gi,"").explode().join(" ").toCamelCase()+r.toUpperCase(),u=D.explode(e),c=this.key,l=[];return p.each(u,function(e){if(D.isEmpty(e))throw Error(_.error.invalidArguments)}),!t&&this.views[a]instanceof Array?this.views[a]:0===this.total?[]:(s=function(e,t){var r=L.clone(e),n=e[0],o={},a=[];return p.remove(r,0),o=i(n,t,h.desc.test(n)),p.each(o.order,function(e){2>o.registry[e].length||r.length>0&&(o.registry[e]=s(r,o.registry[e]))}),p.each(o.order,function(e){a=a.concat(o.registry[e])}),a},i=function(e,t,n){e=e.replace(/\s*asc/gi,"");var i=e.replace(h.desc,""),s=c===i,a=[],u={};return p.each(t,function(e){var t=s?e.key:e.data[i],n=null===t?"null":""+t;switch(r){case"ci":n=D.toCamelCase(n);break;case"cs":n=D.trim(n);break;case"ms":n=D.trim(n).slice(0,1).toLowerCase()}u[n]instanceof Array||(u[n]=[],a.push(n)),u[n].push(e)}),a.sort(p.sort),n&&a.reverse(),p.each(a,function(t){1!==u[t].length&&(u[t]=o(u[t],e,i,n,s))}),{order:a,registry:u}},o=function(e,t,r,n,i){var o=[],s=[];return p.each(e,function(e,t){var n=i?e.key:e.data[r];n=D.trim(""+n)+":::"+t,o.push(n.replace(h.nil,'""'))}),o.length>1&&(o.sort(p.sort),n&&o.reverse()),p.each(o,function(t){s.push(e[h.sort_needle.exec(t)[1]])}),s},l=s(u,void 0===n?this.records:this.select(n)),this.views[a]=l,l)},storage:function(e,t,r){var n,i,o,s=!1,a="session"===r&&"undefined"!=typeof sessionStorage;if(!h.number_string_object.test(typeof e)||!h.get_remove_set.test(t))throw Error(_.error.invalidArguments);switch(s=h.number_string.test(e)||e.hasOwnProperty("key")&&!e.hasOwnProperty("parentNode"),!s||e instanceof Object||(e=this.get(e)),i=s?e.key:e.parentNode.id,t){case"get":if(n=a?sessionStorage.getItem(i):localStorage.getItem(i),null===n)throw Error(_.error.invalidArguments);n=k.decode(n),s?this.set(i,n,!0):L.merge(this,n),n=s?e:this;break;case"remove":a?sessionStorage.removeItem(i):localStorage.removeItem(i),n=this;break;case"set":o=k.encode(s?e.data:{total:this.total,keys:this.keys,records:this.records}),a?sessionStorage.setItem(i,o):localStorage.setItem(i,o),n=this}return n},sync:function(e){if(null===this.uri||D.isEmpty(this.uri))throw Error(_.error.invalidArguments);e=e===!0;var t,r,n,i=this,o=this.events===!0,s=O.factory(),a=O.factory();return s.then(function(e){if("object"!=typeof e)throw Error(_.error.expectedObject);var t,r=!1;return null!==i.source&&(e=L.walk(e,i.source)),e instanceof Array?t=e:L.iterate(e,function(e){!r&&e instanceof Array&&(r=!0,t=e)}),void 0===t&&(t=[e]),i.batch("set",t,!0,void 0).then(function(e){a.resolve(e)},function(e){a.reject(e)}),t},function(e){a.reject(e)}),t=a.then(function(t){e&&i.reindex(),o&&C.fire(i.parentNode,"afterDataSync",t)},function(e){throw o&&C.fire(i.parentNode,"failedDataSync",e),e}),r=function(e){s.resolve(e)},n=function(e){s.reject(e)},o&&C.fire(i.parentNode,"beforeDataSync"),null!==this.callback?m.jsonp(this.uri,r,n,{callback:this.callback}):m.request(this.uri,"GET",r,n,null,L.merge({withCredentials:this.credentials},this.headers)),t},teardown:function(){var e,t=this.uri;return null!==t&&(v.expire(t,!0),C.remove(t),e=this.parentNode.id+"DataExpire",L.clearTimers(e),p.each(this.datalists,function(e){e.teardown()}),p.each(this.records,function(e){v.expire(t+"/"+e.key,!0),C.remove(t+"/"+e.key),L.iterate(e.data,function(e){null!==e&&e.hasOwnProperty("data")&&"function"==typeof e.data.teardown&&(C.remove(e.id),e.data.teardown())})})),this.clear(!0),C.fire(this.parentNode,"afterDataTeardown"),this},unique:function(e){var t=[];return p.each(this.records,function(r){p.add(t,r.data[e])}),t},update:function(e,t){var r,n,i=this.get(e),o=this;if(void 0===i)throw Error(_.error.invalidArguments);return r=L.merge(L.clone(i.data),t),n=O.factory(),this.set(e,r).then(function(e){n.resolve(e)},function(e){l(e,arguments,o)}),n}}};DataStore.prototype=g.methods,DataStore.prototype.constructor=DataStore;var b={factory:function(e,t,r,n){var i,o,s=[t];if(!(e instanceof Element&&"object"==typeof t&&h.string_object.test(typeof r)))throw Error(_.error.invalidArguments);return i=E.create("ul",{"class":"list",id:t.parentNode.id+"-datalist"},e),o=new DataList(i,s[0],r),n instanceof Object&&L.merge(o,n),o.store.datalists.push(o),(null===o.store.uri||o.store.loaded)&&o.refresh(!0),o},methods:{del:function(e){return"number"==typeof this.pageIndex&&"number"==typeof this.pageSize?this.refresh():(C.fire(this.element,"beforeDataListRefresh"),p.each(this.element.find("> li[data-key='"+e.key+"']"),function(e){E.destroy(e)}),C.fire(this.element,"afterDataListRefresh")),this},page:function(e){if(isNaN(e))throw Error(_.error.invalidArguments);return this.pageIndex=e,this.refresh(),this},pages:function(){var e,r=this.element,n=this.pageIndex,i=this.pagination,o=this.pageRange,s=N.round(N.half(o),"down"),a=n-s,u=n+s,c=this,l=b.pages.call(this);if(!h.top_bottom.test(i))throw Error(_.error.invalidArguments);return p.each(t("#"+r.id+"-pages-top, #"+r.id+"-pages-bottom"),function(e){void 0!==e&&E.destroy(e)}),0===this.total||1===l?this:(1>a&&(e=N.diff(a,1),a+=e,u+=e),u>l&&(u=l,a=u-o+1,1>a&&(a=1)),p.each(D.explode(i),function(e){var t,i=!1,o=n>1,s=l>=n+1,d=!(l>n);for(t=E.create("ul",{"class":"list pages "+e,id:r.id+"-pages-"+e},r,"bottom"===e?"after":"before"),E.create(o?"a":"span",{"class":"first page","data-page":1,innerHTML:"&lt;&lt;"},E.create("li",{},t)),E.create(o?"a":"span",{"class":"prev page","data-page":n-1,innerHTML:"&lt;"},E.create("li",{},t)),e=a;u>=e;e++)i=e===n,E.create(i?"span":"a",{"class":i?"current page":"page","data-page":e,innerHTML:e},E.create("li",{},t));E.create(s?"a":"span",{"class":"next page","data-page":s?n+1:null,innerHTML:"&gt;"},E.create("li",{},t)),E.create(d?"span":"a",{"class":"last page","data-page":d?null:l,innerHTML:"&gt;&gt;"},E.create("li",{},t)),C.remove(t,"click"),C.add(t,"click",function(e){var t=L.target(e);L.stop(e),"A"===t.nodeName&&(c.page(E.data(t,"page")),window.scrollTo(0,0))},"pagination")}),this)},refresh:function(e,r){e=e!==!1,r=r===!0;var n,i,o=this.element,s="object"==typeof this.template,a=(!s&&(""+this.template).replace(/\{\{|\}\}/g,"")===this.store.key,[]),u=[],c=this,l="function"==typeof this.callback,d=RegExp(),f=[],v=[];if(C.fire(o,"beforeDataListRefresh"),n=s?function(e){var t=k.encode(c.template),r=p.unique(t.match(/\{\{[\w\.]+\}\}/g));return t=t.replace("{{"+c.store.key+"}}",e.key),p.each(r,function(r){var n=r.replace(/\{\{|\}\}/g,""),i=L.walk(e.data,n);d.compile(r,"g"),t=t.replace(d,k.encode(i).replace(/(^")|("$)/g,""))}),t=k.decode(t.replace(/\{\{.*\}\}/g,c.placeholder)),{li:t}}:function(e){var t=c.template,r=p.unique(t.match(/\{\{[\w\.]+\}\}/g));return t=t.replace("{{"+c.store.key+"}}",e.key),p.each(r,function(r){var n=r.replace(/\{\{|\}\}/g,""),i=L.walk(e.data,n);d.compile(r,"g"),t=t.replace(d,i)}),t=t.replace(/\{\{.*\}\}/g,c.placeholder),{li:t}},a=null===this.where?D.isEmpty(this.order)?this.store.get():this.store.sort(this.order,r,this.sensitivity):D.isEmpty(this.order)?this.store.select(this.where):this.store.sort(this.order,r,this.sensitivity,this.where),p.each(a,function(e){null!==c.filter&&c.filter instanceof Object?L.iterate(c.filter,function(t,r){var i,o;p.contains(f,e.key)||(t=D.explode(t),i=RegExp(),o=r===c.store.key,p.each(t,function(t){return L.compile(i,t,"i"),o&&i.test(e.key)||void 0!==e.data[r]&&i.test(e.data[r])?(f.push(e.key),u.push({key:e.key,template:n(e)}),!1):void 0}))}):u.push({key:e.key,template:n(e)})}),this.total=u.length,"number"==typeof this.pageIndex&&"number"==typeof this.pageSize){if(i=b.pages.call(this),i>0&&this.pageIndex>i)return this.page(i);this.total>0&&(v=b.range.call(this),u=u.limit(v[0],v[1]))}return e?(E.clear(o),0===this.total?E.create("li",{innerHTML:this.emptyMsg},o):p.each(u,function(e){var t=L.tpl(e.template,o);E.data(t,"key",e.key),l&&c.callback(t)})):(p.each(E.find(o,"> li"),function(e){E.addClass(e,"hidden")}),p.each(u,function(e){p.each(E.find(o,"> li[data-key='"+e.key+"']"),function(e){E.removeClass(e,"hidden")})})),h.top_bottom.test(this.pagination)&&"number"==typeof this.pageIndex&&"number"==typeof this.pageSize?this.pages():p.each(t("#"+o.id+"-pages-top, #"+o.id+"-pages-bottom"),function(e){E.destroy(e)}),C.fire(o,"afterDataListRefresh"),this},sort:function(e,t,r){if("string"!=typeof e)throw Error(_.error.invalidArguments);return this.element.fire("beforeDataListSort"),this.order=e,this.sensitivity=t||"ci",this.refresh(!0,r),this.element.fire("afterDataListSort"),this},teardown:function(e){e=e===!0;var r=this,n=this.element.id;return C.remove(n),p.each(t("#"+n+"-pages-top, #"+n+"-pages-bottom"),function(e){C.remove(e)}),p.each(this.store.datalists,function(e,t){return e.id===r.id?(this.remove(t),!1):void 0}),e&&(E.destroy(this.element),this.element=null),this}},pages:function(){if(isNaN(this.pageSize))throw Error(_.error.invalidArguments);return N.round(this.total/this.pageSize,"up")},range:function(){var e=this.pageIndex*this.pageSize-this.pageSize,t=this.pageSize;return[e,t]}};DataList.prototype=b.methods,DataList.prototype.constructor=DataList;var w={factory:function(){return new Deferred},methods:{always:function(e){if("function"!=typeof e)throw Error(_.error.invalidArguments);if(this.promise.resolved())throw Error(_.error.promiseResolved.replace("{{outcome}}",this.promise.outcome));return this.onAlways.push(e),this},done:function(e){if("function"!=typeof e)throw Error(_.error.invalidArguments);if(this.promise.resolved())throw Error(_.error.promiseResolved.replace("{{outcome}}",this.promise.outcome));return this.onDone.push(e),this},fail:function(e){if("function"!=typeof e)throw Error(_.error.invalidArguments);if(this.promise.resolved())throw Error(_.error.promiseResolved.replace("{{outcome}}",this.promise.outcome));return this.onFail.push(e),this},isRejected:function(){return this.promise.state===O.state.broken},isResolved:function(){return this.promise.state===O.state.resolved},reject:function(e){return this.promise.reject.call(this.promise,e),this},resolve:function(e){return this.promise.resolve.call(this.promise,e),this}}};Deferred.prototype=w.methods,Deferred.prototype.constructor=Deferred;var E={attr:function(e,r,n){var i,o;if(h.svg.test(e.namespaceURI))void 0===n?(o=e.getAttributeNS(e.namespaceURI,r),o=null===o||D.isEmpty(o)?void 0:L.coerce(o)):e.setAttributeNS(e.namespaceURI,r,n);else{if("string"==typeof n&&(n=D.trim(n)),h.checked_disabled.test(r)&&void 0===n)return L.coerce(e[r]);if(h.checked_disabled.test(r)&&void 0!==n)e[r]=n;else{if("SELECT"===e.nodeName&&"selected"===r&&void 0===n)return t("#"+e.id+' option[selected="selected"]')[0]||t("#"+e.id+" option")[0];if("SELECT"===e.nodeName&&"selected"===r&&void 0!==n)i=t("#"+e.id+' option[selected="selected"]')[0],void 0!==i&&(i.selected=!1,i.removeAttribute("selected")),i=t("#"+e.id+' option[value="'+n+'"]')[0],i.selected=!0,i.setAttribute("selected","selected");else{if(void 0===n)return o=e.getAttribute(r),o=null===o||D.isEmpty(o)?void 0:L.coerce(o);e.setAttribute(r,n)}}}return e},clear:function(e){return"function"==typeof e.reset?e.reset():void 0!==e.value?E.update(e,{innerHTML:"",value:""}):E.update(e,{innerHTML:""}),e},create:function(e,r,n,i){var s,a,u,c=!1;if(void 0===e||D.isEmpty(e))throw Error(_.error.invalidArguments);if(void 0!==n?(n=L.object(n),c=void 0!==n.namespaceURI&&h.svg.test(n.namespaceURI)):void 0===r||"string"!=typeof r&&void 0===r.childNodes?n=o.body:(n=L.object(r),c=void 0!==n.namespaceURI&&h.svg.test(n.namespaceURI)),void 0===n)throw Error(_.error.invalidArguments);return u=!(n instanceof Element),a=void 0!==r&&"string"!=typeof r&&void 0===r.childNodes&&void 0!==r.id&&void 0===t("#"+r.id)?r.id:c?void 0:L.genId(void 0,!0),void 0!==r&&void 0!==r.id&&delete r.id,s=c||h.svg.test(e)?o.createElementNS("http://www.w3.org/2000/svg",e):o.createElement(e),void 0!==a&&(s.id=a),"object"==typeof r&&void 0===r.childNodes&&E.update(s,r),void 0===i||"last"===i?n.appendChild(s):"first"===i?E.prependChild(n,s):"after"===i?(i={},i.after=n,n=n.parentNode,n.insertBefore(s,i.after.nextSibling)):void 0!==i.after?n.insertBefore(s,i.after.nextSibling):"before"===i?(i={},i.before=n,n=n.parentNode,n.insertBefore(s,i.before)):void 0!==i.before?n.insertBefore(s,i.before):n.appendChild(s),s},css:function(e,t,r){e=L.object(e),t=D.toCamelCase(t);var n;return void 0!==r?(e.style[t]=r,n=e):n=e.style[t],n},data:function(e,t,r){var n,i="object"==typeof e.dataset;return i&&(t=D.toCamelCase(t)),void 0!==r?(i?e.dataset[t]=r:E.attr(e,"data-"+t,r),n=e):n=L.coerce(i?e.dataset[t]:E.attr(e,"data-"+t)),n},destroy:function(e){return C.remove(e),null!==e.parentNode&&e.parentNode.removeChild(e),void 0},disable:function(e){return"boolean"!=typeof e.disabled||e.disabled||(e.disabled=!0),e},dispatch:function(){return"function"==typeof CustomEvent?function(e,t,r,n,i){var o=new CustomEvent(t);return n=n!==!1,i=i!==!1,o.initCustomEvent(t,n,i,r||{}),e.dispatchEvent(o),e}:void 0!==o&&"function"==typeof o.createEvent?function(e,t,r,n,i){var s=o.createEvent("HTMLEvents");return n=n!==!1,i=i!==!1,s.initEvent(t,n,i),s.detail=r||{},e.dispatchEvent(s),e}:void 0!==o&&"object"==typeof o.createEventObject?function(e,t,r,n){var i=o.createEventObject();i.cancelBubble=n!==!1,i.detail=r||{},e.fireEvent("on"+t,i)}:function(){throw Error(_.error.notSupported)}}(),enable:function(e){return"boolean"==typeof e.disabled&&e.disabled&&(e.disabled=!1),e},find:function(e,r){var n=[];return L.genId(e,!0),p.each(D.explode(r),function(r){n=n.concat(t("#"+e.id+" "+r))}),n},has:function(e,t){var r=E.find(e,t);return!isNaN(r.length)&&r.length>0},hasClass:function(e,t){return e.classList.contains(t)},hide:function(e){return"boolean"==typeof e.hidden?e.hidden=!0:(e["data-display"]=e.style.display,e.style.display="none"),e},hidden:function(e){return"none"===e.style.display||"boolean"==typeof e.hidden&&e.hidden},html:function(e,t){return void 0===t?D.trim(e.innerHTML):E.update(e,{innerHTML:D.trim(t)})},is:function(e,t){return/^:/.test(t)?p.contains(E.find(e.parentNode,e.nodeName.toLowerCase()+t),e):RegExp(t,"i").test(e.nodeName)},isAlphaNum:function(e){return"FORM"===e.nodeName?!1:I.test({alphanum:e.value||E.text(e)}).pass},isBoolean:function(e){return"FORM"===e.nodeName?!1:I.test({"boolean":e.value||E.text(e)}).pass},isChecked:function(e){return"INPUT"!==e.nodeName?!1:E.attr(e,"checked")},isDate:function(e){return"FORM"===e.nodeName?!1:D.isDate(e.value||E.text(e))},isDisabled:function(e){return"INPUT"!==e.nodeName?!1:E.attr(e,"disabled")},isDomain:function(e){return"FORM"===e.nodeName?!1:D.isDomain(e.value||E.text(e))},isEmail:function(e){return"FORM"===e.nodeName?!1:D.isEmail(e.value||E.text(e))},isEmpty:function(e){return"FORM"===e.nodeName?!1:D.isEmpty(e.value||E.text(e))},isIP:function(e){return"FORM"===e.nodeName?!1:D.isIP(e.value||E.text(e))},isInt:function(e){return"FORM"===e.nodeName?!1:D.isInt(e.value||E.text(e))},isNumber:function(e){return"FORM"===e.nodeName?!1:D.isNumber(e.value||E.text(e))},isPhone:function(e){return"FORM"===e.nodeName?!1:D.isPhone(e.value||E.text(e))},isUrl:function(e){return"FORM"===e.nodeName?!1:D.isUrl(e.value||E.text(e))},klass:function(e,t,r){return r=r!==!1,t=D.explode(t," "),r?p.each(t,function(t){e.classList.add(t)}):p.each(t,function(t){return"*"===t?(p.each(e.classList,function(e){this.remove(e)}),!1):(e.classList.remove(t),void 0)}),e},position:function(t){var r,n,i,s;if(r=n=0,s=t.offsetWidth,i=t.offsetHeight,t.offsetParent)for(n=t.offsetTop,r=t.offsetLeft;t=t.offsetParent;)r+=t.offsetLeft,n+=t.offsetTop;return{top:n,right:o.documentElement.clientWidth-(r+s),bottom:o.documentElement.clientHeight+e.scrollY-(n+i),left:r}},prependChild:function(e,t){return 0===e.childNodes.length?e.appendChild(t):e.insertBefore(t,e.childNodes[0])},removeAttr:function(e,r){var n;return h.svg.test(e.namespaceURI)?e.removeAttributeNS(e.namespaceURI,r):"SELECT"===e.nodeName&&"selected"===r?(n=t("#"+e.id+' option[selected="selected"]')[0],void 0!==n&&(n.selected=!1,n.removeAttribute("selected"))):e.removeAttribute(r),e},serialize:function(e,t,r){e=L.object(e),t=t===!0,r=r!==!1;var n,i=[],o={};return e instanceof Array?p.each(e,function(e){i.push(L.object(e))}):i="FORM"===e.nodeName?void 0!==e.elements?p.cast(e.elements):e.find("button, input, select, textarea"):[e],p.each(i,function(e){"FORM"===e.nodeName?L.merge(o,k.decode(E.serialize(e))):void 0===o[e.name]&&(o[e.name]=E.val(e))}),t?(n="",L.iterate(o,function(e,t){n+=r?"&"+encodeURIComponent(t)+"="+encodeURIComponent(e):"&"+t+"="+e}),n=n.replace(/^&/,"?")):n=k.encode(o),n},show:function(e){return"boolean"==typeof e.hidden?e.hidden=!1:e.style.display=E.data(e,"display")||"inherit",e},size:function(e){var t=function(e){return N.parse(e,10)};return{height:e.offsetHeight+t(e.style.paddingTop||0)+t(e.style.paddingBottom||0)+t(e.style.borderTop||0)+t(e.style.borderBottom||0),width:e.offsetWidth+t(e.style.paddingLeft||0)+t(e.style.paddingRight||0)+t(e.style.borderLeft||0)+t(e.style.borderRight||0)}},text:function(e,t){var r=void 0!==e.textContent?"textContent":"innerText",n={},i=!1;return t!==void 0&&(i=!0,n[r]=t),i?E.update(e,n):e[r]},toggleClass:function(e,t){return e.classList.toggle(t),e},update:function(e,t){return t=t||{},L.iterate(t,function(t,r){if(h.element_update.test(r))e[r]=t;else if("class"===r)D.isEmpty(t)?E.klass(e,"*",!1):E.klass(e,t);else if(0===r.indexOf("data-"))E.data(e,r.replace("data-",""),t);else if("id"===r){var n=C.listeners;void 0!==n[e.id]&&(n[r]=L.clone(n[e.id]),delete n[e.id])}else E.attr(e,r,t)}),e},val:function(e,r){var n,i="input";if(void 0===r){if(h.radio_checkbox.test(e.type)){if(D.isEmpty(e.name))throw Error(_.error.expectedProperty);p.each(t("input[name='"+e.name+"']"),function(e){return e.checked?(n=e.value,!1):void 0})}else n=h.select.test(e.type)?e.options[e.selectedIndex].value:e.value||E.text(e);void 0!==n&&(n=L.coerce(n)),"string"==typeof n&&(n=D.trim(n))}else r=""+r,h.radio_checkbox.test(e.type)?(i="click",p.each(t("input[name='"+e.name+"']"),function(e){return e.value===r?(e.checked=!0,n=e,!1):void 0})):h.select.test(e.type)?(i="change",p.each(E.find(e,"> *"),function(e){return e.value===r?(e.selected=!0,n=e,!1):void 0})):void 0!==e.value?e.value=r:E.text(e,r),E.dispatch(e,i),n=e;return n},validate:function(e){return"FORM"===e.nodeName?I.test(e):!D.isEmpty(e.value||E.text(e))}},x={factory:function(e,t,r,n){n=n||250;var i,o=[t];if(!(e instanceof Element)||void 0!==t&&void 0===t.store||"string"!=typeof r||D.isEmpty(r))throw Error(_.error.invalidArguments);return i=new DataListFilter(e,o[0],r,n)},methods:{init:function(){return C.add(this.element,"keyup",this.update,"filter",this),C.add(this.element,"input",this.update,"value",this),this},set:function(e){var t={};if("string"!=typeof e||D.isEmpty(e))throw Error(_.error.invalidArguments);return p.each(D.explode(e),function(e){t[e]=""}),this.filters=t,this},teardown:function(){return C.remove(this.element,"keyup","filter"),C.remove(this.element,"input","value"),this},update:function(){var e=this;return L.defer(function(){var t=E.val(e.element);D.isEmpty(t)?e.datalist.filter=null:(L.iterate(e.filters,function(e,r){var n=D.explode(t);n=n.filter(function(e){return!D.isEmpty(e)}),p.each(n,function(e,t){this[t]="^"+D.escape(e).replace("\\*",".*")}),this[r]=n.join(",")}),e.datalist.filter=e.filters),e.datalist.pageIndex=1,e.datalist.refresh(!0,e.datalist.store.datalists.length>1)},this.debounce,this.element.id+"Debounce"),this}}};DataListFilter.prototype=x.methods,DataListFilter.prototype.constructor=DataListFilter;var k={decode:function(e,t){try{return JSON.parse(e)}catch(r){return t!==!0&&l(r,arguments,this),void 0}},encode:function(e,t){try{return JSON.stringify(e)}catch(r){return t!==!0&&l(r,arguments,this),void 0}}},_={common:{back:"Back",cancel:"Cancel",clear:"Clear",close:"Close",cont:"Continue",create:"Create",del:"Delete",edit:"Edit",find:"Find",gen:"Generate",go:"Go",loading:"Loading",next:"Next",login:"Login",ran:"Random",reset:"Reset",save:"Save",search:"Search",submit:"Submit"},day:{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},error:{databaseNotOpen:"Failed to open the Database, possibly exceeded Domain quota",databaseNotSupported:"Client does not support local database storage",databaseWarnInjection:"Possible SQL injection in database transaction, use the &#63; placeholder",elementNotCreated:"Could not create the Element",elementNotFound:"Could not find the Element",expectedArray:"Expected an Array",expectedArrayObject:"Expected an Array or Object",expectedBoolean:"Expected a Boolean value",expectedNumber:"Expected a Number",expectedProperty:"Expected a property, and it was not set",expectedObject:"Expected an Object",invalidArguments:"One or more arguments is invalid",invalidDate:"Invalid Date",invalidFields:"The following required fields are invalid: ",invalidRoute:"The route could not be found",invalidStateNoHeaders:"INVALID_STATE_ERR: Headers have not been received",invalidStateNoSync:"Synchronous XMLHttpRequest requests are not supported",invalidStateNotOpen:"INVALID_STATE_ERR: Object is not open",invalidStateNotSending:"INVALID_STATE_ERR: Object is sending",invalidStateNotUsable:"INVALID_STATE_ERR: Object is not usable",notAvailable:"Requested method is not available",notSupported:"This feature is not supported by this platform",propertyNotFound:"Could not find the requested property",promisePending:"The promise cannot be resolved while pending result",promiseResolved:"The promise has been resolved: {{outcome}}",serverError:"Server error has occurred",serverForbidden:"Forbidden to access URI",serverInvalidMethod:"Method not allowed",serverUnauthorized:"Authorization required to access URI",readOnly:"Property is read only",upgrade:"Your browser is too old to use abaaso, please upgrade"},month:{0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"}},A={clear:function(t){return t=t||"all",C.remove(e,"message","message",t)},send:function(e,t){try{e.postMessage(t,"*")}catch(r){l(r,arguments,this)}return e},recv:function(t,r){return r=r||"all",C.add(e,"message",t,"message",e,r)}},j={enabled:!1,log:!1,diff:{x:null,y:null},pos:{x:null,y:null},prev:{x:null,y:null},view:function(){return m.ie&&9>m.version?"documentElement":"body"},track:function(e){var r=j,n="mousemove",i="tracking";if("object"==typeof e){var s=o[r.view],a=e.pageX?e.pageX:s.scrollLeft+e.clientX,u=e.pageY?e.pageY:s.scrollTop+e.clientY,c=!1;r.pos.x!==a&&(c=!0),t.mouse.prev.x=r.prev.x=N.parse(r.pos.x,10),t.mouse.pos.x=r.pos.x=a,t.mouse.diff.x=r.diff.x=r.pos.x-r.prev.x,r.pos.y!==u&&(c=!0),t.mouse.prev.y=r.prev.y=N.parse(r.pos.y,10),t.mouse.pos.y=r.pos.y=u,t.mouse.diff.y=r.diff.y=r.pos.y-r.prev.y,c&&r.log&&L.log([r.pos.x,r.pos.y,r.diff.x,r.diff.y])}else"boolean"==typeof e&&(e?C.add(o,n,j.track,i):C.remove(o,n,i),t.mouse.enabled=r.enabled=e);return r}},N={diff:function(e,t){if(isNaN(e)||isNaN(t))throw Error(_.error.expectedNumber);return Math.abs(e-t)},even:function(e){return 0===e%2},format:function(e,t,r){if(isNaN(e))throw Error(_.error.expectedNumber);e=""+e,t=t||",",r=r||3;var n,i,o=e.indexOf(".")>-1?"."+e.replace(h.number_format_1,""):"",s=e.replace(h.number_format_2,"").split("").reverse(),a=Math.floor(s.length/r),u=1;for(i=0;a>i;i++)n=1===u?r:r*u+(2===u?1:u-1),s.splice(n,0,t),u++;return s=s.reverse().join(""),s.charAt(0)===t&&(s=s.substring(1)),s+o},half:function(e,t){return void 0!==t?.5===e/t:e/2},odd:function(e){return!N.even(e)},parse:function(e,t){return void 0===t?parseFloat(e):parseInt(e,t)},random:function(e){return e=e||100,Math.floor(Math.random()*(e+1))},round:function(e,t){return e=N.parse(e),void 0===t||D.isEmpty(t)?N.parse(e.toFixed(0)):Math[h.down.test(t)?"floor":"ceil"](e)}},C={listeners:{},alisteners:{},elisteners:{},clisteners:{},log:!1,queue:[],silent:!1,ignore:!1,add:function(e,t,r,n,i,o){if(e=L.object(e),i=i||e,o=o||T.getCurrent(),e instanceof Array)return p.each(e,function(e){C.add(e,t,r,n,i,o)});void 0!==t&&(t=D.explode(t)),n=n||L.genId();var s,a,u=null,c=C.listeners,l=C.alisteners,d=C.elisteners,f=C.clisteners,v=h.observer_globals,m=h.observer_allowed,y=C.id(e);if(T.getCurrent(),void 0===y||null===t||void 0===t||"function"!=typeof r)throw Error(_.error.invalidArguments);return void 0===c[y]&&(c[y]={},l[y]={},f[y]={}),p.each(t,function(t){var h=y+"_"+t;void 0===c[y][t]&&(c[y][t]={},l[y][t]={},f[y][t]=0),void 0===c[y][t][o]&&(c[y][t][o]={},l[y][t][o]=[]),u=v.test(y)||!/\//g.test(y)&&"abaaso"!==y?e:null,null===u||void 0===u||"afterjsonp"===t.toLowerCase()||void 0!==d[h]||!v.test(y)&&"function"!=typeof u.listeners||(s="function"==typeof u.addEventListener,a="object"==typeof u.attachEvent||s,a&&(d[h]=function(r){m.test(r.type)||L.stop(r),C.fire(e,t,r)},u[s?"addEventListener":"attachEvent"]((s?"":"on")+t,d[h],!1))),c[y][t][o][n]={fn:r,scope:i},C.sync(y,t,o),f[y][t]++}),e},decorate:function(e){var t=[["fire",function(){return C.fire.apply(C,[this].concat(p.cast(arguments)))}],["listeners",function(e){return C.list(this,e)}],["on",function(e,t,r,n,i){return C.add(this,e,t,r,n,i)}],["once",function(e,t,r,n,i){return C.once(this,e,t,r,n,i)}],["un",function(e,t){return C.remove(this,e,t)}]];return p.each(t,function(t){L.property(e,t[0],{value:t[1],configurable:!0,enumerable:!0,writable:!0})}),e},discard:function(e){return void 0===e?C.ignore:C.ignore=e===!0},fire:function(e,r){e=L.object(e);var n,i,o,s,a,u=!1,i=p.cast(arguments).remove(0,1);if(C.ignore)return e;if(e instanceof Array)return p.each(e,function(e){i=[e,r].concat(i),C.fire.apply(C,i)}),e;if(n=C.id(e),void 0===n||void 0===r)throw Error(_.error.invalidArguments);return C.silent?C.queue.push({obj:e,event:r}):(o=T.getCurrent(),s=t.logging,p.each(D.explode(r),function(t){s&&L.log(n+" firing "+t),a=C.list(e,t,C.alisteners),void 0!==a.all&&p.each(a.all,function(e){var t=e.fn.apply(e.scope,i);return t===!1?(u=!0,t):void 0}),u||"all"===o||void 0===a[o]||p.each(a[o],function(e){return e.fn.apply(e.scope,i)})})),e},id:function(t){var r;return t===abaaso?r="abaaso":t===e?r="window":u||t!==o?u||t!==o.body?(L.genId(t),r=t.id||("function"==typeof t.toString?""+t:t)):r="body":r="document",r},list:function(e,t,r){e=L.object(e);var n,i=r||C.listeners,o=C.id(e);return n=void 0===i[o]&&void 0===t?{}:void 0===i[o]||void 0!==t&&!D.isEmpty(t)?void 0!==i[o]&&void 0!==i[o][t]?i[o][t]:{}:i[o]},once:function(e,t,r,n,i,o){var s=n||L.genId();if(e=L.object(e),i=i||e,o=o||T.getCurrent(),void 0===e||null===t||void 0===t||"function"!=typeof r)throw Error(_.error.invalidArguments);return e instanceof Array?(p.each(e,function(e){C.once(e,t,r,n,i,o)}),e):(C.add(e,t,function(){r.apply(i,arguments),C.remove(e,t,s,o)},s,i,o),e)},pause:function(e){return e===!0?C.silent=e:e===!1&&(C.silent=e,p.each(C.queue,function(e){C.fire(e.obj,e.event)}),C.queue=[]),e},remove:function(e,t,r,n){if(e=L.object(e),n=n||T.getCurrent(),e instanceof Array)return p.each(e,function(e){C.remove(e,t,r,n)});var i,o=C.listeners,s=C.alisteners,a=C.elisteners,u=C.clisteners,c=C.id(e),l="function"==typeof e.addEventListener,d="object"==typeof e.attachEvent||l;return i=function(t,r){var n="number"==typeof r&&0===(u[c][t]=u[c][t]-r);n&&d&&(e[l?"removeEventListener":"detachEvent"]((l?"":"on")+t,a[c+"_"+t],!1),delete a[c+"_"+t])},void 0===o[c]?e:(void 0===t||null===t?((h.observer_globals.test(c)||"function"==typeof c.listeners)&&L.iterate(a,function(e,t){0===t.indexOf(c+"_")&&i(t.replace(/.*_/,""),1)}),delete o[c],delete s[c],delete u[c]):p.each(D.explode(t),function(e){var t=!1;void 0!==o[c][e]&&(void 0===r?((h.observer_globals.test(c)||"function"==typeof c.listeners)&&i(e,p.keys(o[c][e][n]).length),o[c][e][n]={},t=!0):void 0!==o[c][e][n][r]&&(i(e,1),delete o[c][e][n][r],t=!0),t&&C.sync(c,e,n))}),e)},sum:function(e){var t,r={};return void 0!==e?(e=L.object(e),t=C.id(e),r=L.clone(C.clisteners[t])):r=L.clone(C.clisteners),r},sync:function(e,t,r){C.alisteners[e][t][r]=p.cast(C.listeners[e][t][r])}},O={factory:function(){return new Promise},freeze:function(){return"function"==typeof Object.freeze}(),methods:{reject:function(e){var t=this;return L.defer(function(){O.resolve.call(t,O.state.broken,e)}),this},resolve:function(e){var t=this;return L.defer(function(){O.resolve.call(t,O.state.resolved,e)}),this},resolved:function(){return this.state===O.state.broken||this.state===O.state.resolved},then:function(e,t){var r,n=this,i=O.factory();return r=function(r){var o,s=r?e:t,a=r?!1:!0;try{o=s(n.outcome),a=!1}catch(u){o=u,a=!0,void 0===o||o instanceof Error||("object"==typeof o&&(o=k.encode(o)),o=Error(o))}finally{if(o instanceof Promise)n.state=O.state.pending,n.outcome=null,o.parentNode=n,o.then(function(e){p.each(n.children,function(t){t.resolve(e)})},function(e){p.each(n.children,function(t){t.reject(e)})});else{if(a&&void 0===o)throw Error(_.error.invalidArguments);i[a?"reject":"resolve"](o||n.outcome)}return o}},"function"==typeof e&&O.vouch.call(this,O.state.resolved,function(){return r(!0)}),"function"==typeof t&&O.vouch.call(this,O.state.broken,function(){return r(!1)}),i.parentNode=n,n.children.push(i),i}},resolve:function(e,t){var r,n,i,o=e===O.state.broken?"error":"fulfill",s=this,a=!1,u=!1,c=[];if(this.state!==O.state.pending){if(null!==this.parentNode&&this.parentNode.state===O.state.resolved||this.children.length>0)return;throw Error(_.error.promiseResolved.replace("{{outcome}}",this.outcome))}if(this.state=e,this.outcome=t,p.each(this[o],function(r,o){return i=r.call(s,t),c.push(o),i instanceof Promise?(a=!0,s.outcome=null,s.state=O.state.pending,!1):(i instanceof Error&&(u=!0,n=i,e=O.state.broken),void 0)}),a){for(r=c.length;r--;)p.remove(s[o],c[r]);return i}return this.error=[],this.fulfill=[],u||(i=n,e=O.state.resolved),null!==this.parentNode&&this.parentNode.state===O.state.pending&&this.parentNode[e===O.state.resolved?"resolve":"reject"](i||this.outcome),O.freeze&&Object.freeze(this),this},state:{broken:"rejected",pending:"pending",resolved:"fulfilled"},vouch:function(e,t){if(D.isEmpty(e))throw Error(_.error.invalidArguments);return this.state===O.state.pending?this[e===O.state.resolved?"fulfill":"error"].push(t):this.state===e&&t(this.outcome),this}};Promise.prototype=O.methods,Promise.prototype.constructor=Promise;var S={current:"",initial:null,reg:RegExp(),routes:{},method:function(e){return h.route_methods.test(e)?e.toLowerCase():"all"},del:function(e,t,r){r=r||"all",t=S.method(t);
var n="error"===e;if(n&&"all"!==t||!n&&S.routes[r][t].hasOwnProperty(e))return S.initial===e&&(S.initial=null),delete S.routes[r][t][e];throw Error(_.error.invalidArguments)},hash:function(e){var t="",r=/\#|\!\/|\?.*/g;return u||(void 0===e?t=o.location.hash.replace(r,""):(t=e.replace(r,""),o.location.hash="!/"+t)),t},hostname:function(e){return S.routes.hasOwnProperty(e)||(S.routes[e]={all:{},"delete":{},get:{},post:{},put:{}}),S.routes[e]},init:function(){var e=o.location.hash;D.isEmpty(e)?S.hash(null!==S.initial?S.initial:p.cast(S.routes.all.all,!0).remove("error")[0]):S.load(e)},list:function(e,t){t=t||"all";var r;return u?void 0!==e&&S.routes.hasOwnProperty(t)?r=p.cast(S.routes[t][S.method(e)],!0):(r=[],S.routes.hasOwnProperty(t)&&L.iterate(S.routes[t],function(e,t){r[t]=[],L.iterate(e,function(e,n){r[t].push(n)})})):r=p.cast(S.routes.all.all,!0),u||"all"===t||L.iterate(S.routes.all,function(e,t){void 0===r[t]&&(r[t]=[]),L.iterate(e,function(e,n){r[t].push(n)})}),r},load:function(e,t,r,n){r=r||"all",n=n||"all";var i,o,s="",a="",c=!0,l=!1,d=S.method(r.method||r);return h.route_nget.test(d)&&(d="get"),e=e.replace(/\#|\!\/|\?.*/g,""),u||(S.current=e),i=function(e,t,r){void 0!==S.routes[e][t][r]?(s=r,a=t):"all"!==t&&void 0!==S.routes[e].all[r]?(s=r,a="all"):(L.iterate(S.routes[e][t],function(e,n){return o(n,t,r)}),D.isEmpty(s)&&"all"!==t&&L.iterate(S.routes[e].all,function(e,t){return o(t,"all",r)}))},o=function(e,t,r){return L.compile(S.reg,"^"+e+"$")&&S.reg.test(r)?(s=e,a=t,!1):void 0},"all"===n||S.routes.hasOwnProperty(n)||(p.each(p.cast(S.routes,!0),function(e){var t=RegExp(e.replace(/^\*/,".*"));return t.test(n)?(n=e,l=!0,!1):void 0}),l||(n="all")),i(n,d,e),D.isEmpty(s)&&("all"!==n&&(n="all",i(n,d,e)),D.isEmpty(s)&&(s="error",a="all",c=!1)),S.routes[n][a][s](t||s,r),c},reset:function(){S.routes={all:{all:{error:function(){if(u)throw Error(_.error.invalidRoute);return D.isEmpty(S.hash())?history.go(-1):(L.error(_.error.invalidRoute),null!==S.initial&&S.hash(S.initial),void 0)}},"delete":{},get:{},put:{},post:{}}}},server:function(e,t,o){var s,a,c,d=25;if(!u)throw Error(_.error.notSupported);return e=e||{},o=o===!0||443===e.port,s=function(e,t){var r=i.parse(e.url),n=e.headers.host.replace(h.header_replace,"");S.load(r.pathname,t,e,n)},a=function(e){l(e,this,arguments),"function"==typeof t&&t(e)},S.enabled=!0,e.host=e.host||void 0,e.port=e.port||8e3,o?(n.globalAgent.maxConnections=e.maxConnections,c=n.createServer(e,s).on("error",a).listen(e.port),c.maxConnections&&(c.maxConnections=e.maxConnections||d)):(r.globalAgent.maxConnections=e.maxConnections||d,c=r.createServer(s).on("error",a).listen(e.port,e.host),c.maxConnections&&(c.maxConnections=e.maxConnections||d)),c},set:function(e,t,r,n){if(n=u?n||"all":"all",r=u?S.method(r):"all","string"!=typeof e||D.isEmpty(e)||"function"!=typeof t)throw Error(_.error.invalidArguments);return S.hostname(n)[r][e]=t,!0}},T=function(){var e,t,r,n,i,o,s={current:"active",previous:null,header:null};return e=function(){return s.current},t=function(e){if(null===e||"string"!=typeof e||s[0]===e||D.isEmpty(e))throw Error(_.error.invalidArguments);return s.previous=s.current,s.current=e,C.fire(abaaso,"state",e),e},r=function(){return s.header},n=function(e){if(null!==e&&("string"!=typeof e||s.header===e||D.isEmpty(e)))throw Error(_.error.invalidArguments);return s.header=e,e},i=function(){return s.previous},o=function(){throw Error(_.error.readOnly)},{getCurrent:e,setCurrent:t,getHeader:r,setHeader:n,getPrevious:i,setPrevious:o}}(),D={capitalize:function(e){return e=D.trim(e),e.charAt(0).toUpperCase()+e.slice(1)},escape:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},explode:function(e,t){return(void 0===t||""==""+t)&&(t=","),D.isEmpty(e)?[]:D.trim(e).split(RegExp("\\s*"+t+"\\s*"))},hyphenate:function(e,t){var r=D.trim(e).replace(/\s+/g,"-");return t===!0&&(r=r.replace(/([A-Z])/g,"-$1").toLowerCase()),r},isAlphaNum:function(e){return I.test({alphanum:e}).pass},isBoolean:function(e){return I.test({"boolean":e}).pass},isDate:function(e){return I.test({date:e}).pass},isDomain:function(e){return I.test({domain:e}).pass},isEmail:function(e){return I.test({email:e}).pass},isEmpty:function(e){return void 0!==e?""===D.trim(e):!0},isIP:function(e){return I.test({ip:e}).pass},isInt:function(e){return I.test({integer:e}).pass},isNumber:function(e){return I.test({number:e}).pass},isPhone:function(e){return I.test({phone:e}).pass},isUrl:function(e){return I.test({url:e}).pass},singular:function(e){return h.plural.test(e)?e.slice(0,-1):e},toCamelCase:function(e){var t=D.trim(e).toLowerCase().split(h.space_hyphen),r=[];return p.each(t,function(e,t){e=D.trim(e),D.isEmpty(e)||r.push(0===t?e:D.capitalize(e))}),r.join("")},trim:function(e){return(""+e).replace(/^(\s+|\t+)|(\s+|\t+)$/g,"")},uncapitalize:function(e){return e=D.trim(e),e.charAt(0).toLowerCase()+e.slice(1)},unhyphenate:function(e,t){t=t===!0;var r="";return e.indexOf("-")>-1?p.each(D.trim(e).split("-"),function(e){r+=(t?D.capitalize(e):e)+" "}):r=t?D.capitalize(e):e,D.trim(r)}},L={timer:{},repeating:{},$:function(e,t){if(void 0===o||void 0===e)return void 0;var r=[],n=[],i=[];return r=D.explode(e),t=t===!0,p.each(r,function(e){var r,n;h.selector_complex.test(e)?(n=p.last(e.split(" ").filter(function(e){return D.isEmpty(e)||">"===e?void 0:!0})),h.hash.test(n)&&!h.selector_many.test(n)?r=o.querySelector(e):(r=o.querySelectorAll(e),t||(r=p.cast(r)))):h.hash.test(e)&&!h.selector_many.test(e)?r=o.querySelector(e):(r=o.querySelectorAll(e),t||(r=p.cast(r))),null!==r&&i.push(r)}),p.each(i,function(e){n=n.concat(e)}),!h.hash.test(e)||h.selector_many.test(e)||h.selector_complex.test(e)||(n=n[0]),n},alias:function(e,t){var r=e,n=t;return L.iterate(n,function(e,t){var i,o;e instanceof RegExp||"function"!=typeof e?e instanceof RegExp||e instanceof Array||!(e instanceof Object)?(i=function(){return n[t]},o=function(e){n[t]=e},L.property(r,t,{enumerable:!0,get:i,set:o,value:n[t]})):(void 0===r[t]&&(r[t]={}),L.alias(r[t],n[t])):r[t]=e.bind(r[t])}),e},clearTimers:function(e){if(void 0===e||e.isEmpty())throw Error(_.error.invalidArguments);void 0!==L.timer[e]&&(clearTimeout(L.timer[e]),delete L.timer[e]),void 0!==L.repeating[e]&&(clearTimeout(L.repeating[e]),delete L.repeating[e])},clone:function(e){var t;return e instanceof Array?e.concat():"boolean"==typeof e?Boolean(e):"function"==typeof e?e:"number"==typeof e?Number(e):"string"==typeof e?e+"":e instanceof RegExp?e:!u&&!m.ie&&e instanceof Document?M.decode(M.encode(e)):null!==e&&void 0!==e&&e.__proto__!==void 0?L.extend(e.__proto__,e):e instanceof Object?(t=k.encode(e,!0),void 0!==t?(t=k.decode(t),L.iterate(e,function(e,r){"function"==typeof e&&(t[r]=e)})):t=e,t):e},coerce:function(e){var t,r=L.clone(e);return D.isEmpty(r)?r=void 0:"undefined"===r?r=void 0:"null"===r?r=null:h.string_boolean.test(r)?r=h.string_true.test(r):(t=k.decode(r,!0))&&void 0!==t?r=t:null===r||void 0===r||isNaN(Number(r))||(r=Number(r)),r},compile:function(e,t,r){return e.compile(t,r),!0},css:function(e,r){var n,i;return n=E.create("style",{type:"text/css",media:r||"print, screen"},t("head")[0]),n.styleSheet?n.styleSheet.cssText=e:(i=o.createTextNode(e),n.appendChild(i)),n},debounce:function(t,r,n){if("function"!=typeof t)throw Error(_.error.invalidArguments);return r=r||1e3,n=n||e,function(){L.defer(function(){t.apply(n,arguments)},r)}},define:function(e,t,r){e=e.split(".");var n=r,i=e.length;return void 0===r&&(r=this),void 0===t&&(t=null),p.each(e,function(r,o){var s=i>o+1&&!isNaN(N.parse(e[o+1],10)),a=t;isNaN(N.parse(r,10))||(r=N.parse(r,10)),void 0===n[r]?n[r]=s?[]:{}:n[r]instanceof Object&&s?n[r]=p.cast(n[r]):n[r]instanceof Object||(n[r]=n[r]instanceof Array&&!s?p.toObject(n[r]):{}),o+1===i?n[r]=a:n=n[r]}),r},defer:function(e,t,r){var n;return t=t||0,r=r||L.uuid(!0),n=function(){L.clearTimers(r),e()},L.clearTimers(r),L.timer[r]=setTimeout(n,t),r},domId:function(e){return"a"+e.replace(/-/g,"").slice(1)},error:function(e,t,r,n){n=n===!0;var i={arguments:t,message:e.message||e,number:void 0!==e.number?65535&e.number:void 0,scope:r,stack:e.stack||void 0,timestamp:(new Date).toUTCString(),type:e.type||"TypeError"};return L.log(i.stack||i.message,n?"warn":"error"),abaaso.error.log.push(i),C.fire(abaaso,"error",i),void 0},extend:function(){return"function"==typeof Object.create?function(e,t){var r;if(void 0===e)throw Error(_.error.invalidArguments);return r=Object.create(e),t instanceof Object&&L.merge(r,t),r}:function(e,t){var r;if(void 0===e)throw Error(_.error.invalidArguments);return f=function(){},f.prototype=e,r=new f,t instanceof Object&&L.merge(r,t),r}}(),genId:function(e,r){r=r===!0;var n;if(void 0!==e&&(void 0!==e.id&&""!==e.id||e instanceof Array||e instanceof String||"string"==typeof e))return e;if(r){do n=L.domId(L.uuid(!0));while(void 0!==t("#"+n))}else n=L.domId(L.uuid(!0));return"object"==typeof e?(e.id=n,e):n},hex:function(e){var t,r,n,i,o,s,a;if("#"===e.charAt(0))o=e;else{if(t=D.explode(e.replace(/.*\(|\)/g,"")),r=N.parse(t[0]||0),n=N.parse(t[1]||0),i=N.parse(t[2]||0),o=(i|n<<8|r<<16).toString(16),6>o.length)for(a=N.diff(o.length,6),s=-1;a>++s;)o="0"+o;o="#"+o}return o},iterate:function(){return"function"==typeof Object.keys?function(e,t){if("function"!=typeof t)throw Error(_.error.invalidArguments);return p.each(Object.keys(e),function(r){return t.call(e,e[r],r)}),e}:function(e,t){var r,n,i=Object.prototype.hasOwnProperty;if("function"!=typeof t)throw Error(_.error.invalidArguments);for(r in e){if(!i.call(e,r))break;if(n=t.call(e,e[r],r),n===!1)break}return e}}(),loading:function(e){var t=abaaso.loading;if(e=L.object(e),e instanceof Array)return p.each(e,function(e){L.loading(e)});if(null===t.url||void 0===e)throw Error(_.error.invalidArguments);return void 0===t.image&&(t.image=new Image,t.image.src=t.url),E.clear(e),E.create("img",{alt:_.common.loading,src:t.image.src},E.create("div",{"class":"loading"},e)),e},log:function(e,t){var r,n;"undefined"!=typeof console&&(r="object"!=typeof e,n=r?"["+(new Date).toLocaleTimeString()+"] "+e:e,console[t||"log"](n))},merge:function(e,t){return L.iterate(t,function(t,r){e[r]=L.clone(t)}),e},module:function(e,r){if(void 0!==t[e]||!r instanceof Object)throw Error(_.error.invalidArguments);return t[e]=r,t[e]},object:function(e){return"object"==typeof e?e:"#"===(""+e).charAt(0)?t(e):e},parse:function(e){var t={},r={};return void 0===e&&(e=u?"":s.href),u?t=i.parse(e):(t=o.createElement("a"),t.href=e),u&&L.iterate(t,function(e,r){null===e&&(t[r]=void 0)}),r={auth:u?null:h.auth.exec(e),protocol:t.protocol||"http:",hostname:t.hostname||"localhost",port:D.isEmpty(t.port)?"":N.parse(t.port,10),pathname:t.pathname,search:t.search||"",hash:t.hash||"",host:t.host||"localhost"},m.ie&&(":"===r.protocol&&(r.protocol=s.protocol),D.isEmpty(r.hostname)&&(r.hostname=s.hostname),D.isEmpty(r.host)&&(r.host=s.host),"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname)),r.auth=t.auth||(null===r.auth?"":r.auth[1]),r.href=t.href||r.protocol+"//"+(D.isEmpty(r.auth)?"":r.auth+"@")+r.host+r.pathname+r.search+r.hash,r.path=t.path||r.pathname+r.search,r.query=L.queryString(null,r.search),r},property:function(){return(u||!m.ie||m.version>8)&&"function"==typeof Object.defineProperty?function(e,t,r){if(!(r instanceof Object))throw Error(_.error.invalidArguments);void 0!==r.value&&void 0!==r.get&&delete r.value,Object.defineProperty(e,t,r)}:function(e,t,r){if(!(r instanceof Object))throw Error(_.error.invalidArguments);return e[t]=r.value,e}},proto:function(e,t){var r;return r={array:{add:function(e){return p.add(this,e)},addClass:function(e){return p.each(this,function(t){E.klass(t,e)})},after:function(e,t){var r=[];return p.each(this,function(n){r.push(E.create(e,t,n,"after"))}),r},append:function(e,t){var r=[];return p.each(this,function(n){r.push(E.create(e,t,n,"last"))}),r},attr:function(e,t){var r=[];return p.each(this,function(n){r.push(E.attr(n,e,t))}),r},before:function(e,t){var r=[];return p.each(this,function(n){r.push(E.create(e,t,n,"before"))}),r},chunk:function(e){return p.chunk(this,e)},clear:function(){return!u&&this[0]instanceof Element?p.each(this,function(e){E.clear(e)}):p.clear(this)},clone:function(){return L.clone(this)},collect:function(e){return p.collect(this,e)},compact:function(){return p.compact(this)},contains:function(e){return p.contains(this,e)},count:function(e){return p.count(this,e)},create:function(e,t,r){var n=[];return p.each(this,function(i){n.push(E.create(e,t,i,r))}),n},css:function(e,t){return p.each(this,function(r){E.css(r,e,t)})},data:function(e,t){var r=[];return p.each(this,function(n){r.push(E.data(n,e,t))}),r},diff:function(e){return p.diff(this,e)},disable:function(){return p.each(this,function(e){E.disable(e)})},dispatch:function(e,t,r,n){return p.each(this,function(i){E.dispatch(i,e,t,r,n)})},destroy:function(){return p.each(this,function(e){E.destroy(e)}),[]},each:function(e){return p.each(this,e)},empty:function(){return p.empty(this)},enable:function(){return p.each(this,function(e){E.enable(e)})},equal:function(e){return p.equal(this,e)},fill:function(e,t,r){return p.fill(this,e,t,r)},find:function(e){var t=[];return p.each(this,function(r){r.find(e).each(function(e){t.add(e)})}),t},fire:function(){var e=arguments;return p.each(this,function(t){C.fire.apply(C,[t].concat(p.cast(e)))})},first:function(){return p.first(this)},flat:function(){return p.flat(this)},genId:function(){return p.each(this,function(e){L.genId(e)})},get:function(e,t){var r=[];return p.each(this,function(n,i){n.get(e,t,function(e){r[i]=e},function(e){r[i]=e})}),r},has:function(e){var t=[];return p.each(this,function(r){t.push(E.has(r,e))}),t},hasClass:function(e){var t=[];return p.each(this,function(r){t.push(E.hasClass(r,e))}),t},hide:function(){return p.each(this,function(e){E.hide(e)})},html:function(e){var t;return void 0!==e?p.each(this,function(t){E.html(t,e)}):(t=[],p.each(this,function(e){t.push(E.html(e))}),t)},index:function(e){return p.index(this,e)},indexed:function(){return p.indexed(this)},intersect:function(e){return p.intersect(this,e)},is:function(e){var t=[];return p.each(this,function(r){t.push(E.is(r,e))}),t},isAlphaNum:function(){var e=[];return p.each(this,function(t){e.push(t.isAlphaNum())}),e},isBoolean:function(){var e=[];return p.each(this,function(t){e.push(t.isBoolean())}),e},isChecked:function(){var e=[];return p.each(this,function(t){e.push(t.isChecked())}),e},isDate:function(){var e=[];return p.each(this,function(t){e.push(t.isDate())}),e},isDisabled:function(){var e=[];return p.each(this,function(t){e.push(E.isDisabled(t))}),e},isDomain:function(){var e=[];return p.each(this,function(t){e.push(t.isDomain())}),e},isEmail:function(){var e=[];return p.each(this,function(t){e.push(t.isEmail())}),e},isEmpty:function(){var e=[];return p.each(this,function(t){e.push(t.isEmpty())}),e},isHidden:function(){var e=[];return p.each(this,function(t){e.push(E.isHidden(t))}),e},isIP:function(){var e=[];return p.each(this,function(t){e.push(t.isIP())}),e},isInt:function(){var e=[];return p.each(this,function(t){e.push(t.isInt())}),e},isNumber:function(){var e=[];return p.each(this,function(t){e.push(t.isNumber())}),e},isPhone:function(){var e=[];return p.each(this,function(t){e.push(t.isPhone())}),e},isUrl:function(){var e=[];return p.each(this,function(t){e.push(t.isUrl())}),e},keep_if:function(e){return p.keep_if(this,e)},keys:function(){return p.keys(this)},last:function(e){return p.last(this,e)},limit:function(e,t){return p.limit(this,e,t)},listeners:function(e){var t=[];return p.each(this,function(r){p.merge(t,C.listeners(r,e))}),t},loading:function(){return p.each(this,function(e){L.loading(e)})},max:function(){return p.max(this)},mean:function(){return p.mean(this)},median:function(){return p.median(this)},merge:function(e){return p.merge(this,e)},min:function(){return p.min(this)},mingle:function(e){return p.mingle(this,e)},mode:function(){return p.mode(this)},on:function(e,t,r,n,i){return p.each(this,function(o){C.add(o,e,t,r,n||o,i)})},once:function(e,t,r,n,i){return p.each(this,function(o){C.once(o,e,t,r,n||o,i)})},position:function(){var e=[];return p.each(this,function(t){e.push(E.position(t))}),e},prepend:function(e,t){var r=[];return p.each(this,function(n){r.push(E.create(e,t,n,"first"))}),r},range:function(){return p.range(this)},rassoc:function(e){return p.rassoc(this,e)},reject:function(e){return p.reject(this,e)},remove:function(e,t){return p.remove(this,e,t)},remove_if:function(e){return p.remove_if(this,e)},remove_while:function(e){return p.remove_while(this,e)},removeAttr:function(e){return p.each(this,function(t){E.removeAttr(t,e)}),this},removeClass:function(e){return p.each(this,function(t){E.klass(t,e,!1)})},replace:function(e){return p.replace(this,e)},rest:function(e){return p.rest(this,e)},rindex:function(e){return p.rindex(this,e)},rotate:function(e){return p.rotate(this,e)},serialize:function(e,t){return E.serialize(this,e,t)},series:function(e,t,r){return p.series(e,t,r)},show:function(){return p.each(this,function(e){E.show(e)})},size:function(){var e=[];return p.each(this,function(t){e.push(E.size(t))}),e},split:function(e){return p.split(this,e)},sum:function(){return p.sum(this)},take:function(e){return p.take(this,e)},text:function(e){return p.each(this,function(t){"object"!=typeof t&&(t=L.object(t)),"function"==typeof t.text&&t.text(e)})},tpl:function(e){return p.each(this,function(t){L.tpl(e,t)})},toggleClass:function(e){return p.each(this,function(t){E.toggleClass(t,e)})},total:function(){return p.total(this)},toObject:function(){return p.toObject(this)},un:function(e,t,r){return p.each(this,function(n){C.remove(n,e,t,r)})},unique:function(){return p.unique(this)},update:function(e){return p.each(this,function(t){E.update(t,e)})},val:function(e){var t=[],r=null,n=!0;return p.each(this,function(i){null!==r&&(n=r===i.type),r=i.type,"function"==typeof i.val&&t.push(i.val(e))}),n?t[0]:t},validate:function(){var e=[];return p.each(this,function(t){e.push(E.validate(t))}),e},zip:function(){return p.zip(this,arguments)}},element:{addClass:function(e){return E.klass(this,e,!0)},after:function(e,t){return E.create(e,t,this,"after")},append:function(e,t){return E.create(e,t,this,"last")},attr:function(e,t){return E.attr(this,e,t)},before:function(e,t){return E.create(e,t,this,"before")},clear:function(){return E.clear(this)},create:function(e,t,r){return E.create(e,t,this,r)},css:function(e,t){return E.css(this,e,t)},data:function(e,t){return E.data(this,e,t)},destroy:function(){return E.destroy(this)},disable:function(){return E.disable(this)},dispatch:function(e,t,r,n){return E.dispatch(this,e,t,r,n)},enable:function(){return E.enable(this)},find:function(e){return E.find(this,e)},fire:function(){return C.fire.apply(C,[this].concat(p.cast(arguments)))},genId:function(){return L.genId(this)},get:function(e,t,r,n,i){var o,s=this,a=O.factory();return o=a.then(function(e){E.html(s,e),C.fire(s,"afterGet"),"function"==typeof t&&t.call(s,e)},function(e){throw E.html(s,arg||_.error.serverError),C.fire(s,"failedGet"),"function"==typeof r&&r.call(s,arg),e}),C.fire(this,"beforeGet"),e.get(function(e){a.resolve(e)},function(e){a.reject(e)},n,i),o},has:function(e){return E.has(this,e)},hasClass:function(e){return E.hasClass(this,e)},hide:function(){return E.hide(this)},html:function(e){return E.html(this,e)},is:function(e){return E.is(this,e)},isAlphaNum:function(){return E.isAlphaNum(this)},isBoolean:function(){return E.isBoolean(this)},isChecked:function(){return E.isChecked(this)},isDate:function(){return E.isDate(this)},isDisabled:function(){return E.isDisabled(this)},isDomain:function(){return E.isDomain(this)},isEmail:function(){return E.isEmail(this)},isEmpty:function(){return E.isEmpty(this)},isHidden:function(){return E.hidden(this)},isIP:function(){return E.isIP(this)},isInt:function(){return E.isInt(this)},isNumber:function(){return E.isNumber(this)},isPhone:function(){return E.isPhone(this)},isUrl:function(){return E.isUrl(this)},jsonp:function(e,t,r){var n,i,o=this,s=t;return n=function(e){var t,r=o,n=e,i=s;try{void 0!==i?(i=i.replace(/\]|'|"/g,"").replace(/\./g,"[").split("["),i.each(function(e){if(n=n[isNaN(e)?e:N.parse(e,10)],void 0===n)throw Error(_.error.propertyNotFound)}),t=n):t=e}catch(a){t=_.error.serverError,l(a,arguments,this)}E.html(r,t)},i=m.jsonp(e,n,function(e){throw E.html(o,_.error.serverError),e},r)},listeners:function(e){return C.list(this,e)},loading:function(){return L.loading(this)},on:function(e,t,r,n,i){return C.add(this,e,t,r,n||this,i)},once:function(e,t,r,n,i){return C.once(this,e,t,r,n||this,i)},prepend:function(e,t){return E.create(e,t,this,"first")},prependChild:function(e){return E.prependChild(this,e)},position:function(){return E.position(this)},removeAttr:function(e){return E.removeAttr(this,e)},removeClass:function(e){return E.klass(this,e,!1)},serialize:function(e,t){return E.serialize(this,e,t)},show:function(){return E.show(this)},size:function(){return E.size(this)},text:function(e){return E.text(this,e)},toggleClass:function(e){return E.toggleClass(this,e)},tpl:function(e){return L.tpl(e,this)},un:function(e,t,r){return C.remove(this,e,t,r)},update:function(e){return E.update(this,e)},val:function(e){return E.val(this,e)},validate:function(){return E.validate(this)}},"function":{reflect:function(){return L.reflect(this)},debounce:function(e){return L.debounce(this,e)}},number:{diff:function(e){return N.diff(this,e)},fire:function(){return C.fire.apply(C,[""+this].concat(p.cast(arguments)))},format:function(e,t){return N.format(this,e,t)},half:function(e){return N.half(this,e)},isEven:function(){return N.even(this)},isOdd:function(){return N.odd(this)},listeners:function(e){return C.list(""+this,e)},on:function(e,t,r,n,i){return C.add(""+this,e,t,r,n||this,i),this},once:function(e,t,r,n,i){return C.once(""+this,e,t,r,n||this,i),this},random:function(){return N.random(this)},round:function(){return N.round(this)},roundDown:function(){return N.round(this,"down")},roundUp:function(){return N.round(this,"up")},un:function(e,t,r){return C.remove(""+this,e,t,r),this}},string:{allows:function(e){return m.allows(this,e)},capitalize:function(){return D.capitalize(this)},del:function(e,t,r){return m.request(this,"DELETE",e,t,null,r)},escape:function(){return D.escape(this)},expire:function(e){return v.expire(this,e)},explode:function(e){return D.explode(this,e)},fire:function(){return C.fire.apply(C,[this].concat(p.cast(arguments)))},get:function(e,t,r){return m.request(this,"GET",e,t,null,r)},headers:function(e,t){return m.request(this,"HEAD",e,t)},hyphenate:function(e){return D.hyphenate(this,e)},isAlphaNum:function(){return D.isAlphaNum(this)},isBoolean:function(){return D.isBoolean(this)},isDate:function(){return D.isDate(this)},isDomain:function(){return D.isDomain(this)},isEmail:function(){return D.isEmail(this)},isEmpty:function(){return D.isEmpty(this)},isIP:function(){return D.isIP(this)},isInt:function(){return D.isInt(this)},isNumber:function(){return D.isNumber(this)},isPhone:function(){return D.isPhone(this)},isUrl:function(){return D.isUrl(this)},jsonp:function(e,t,r){return m.jsonp(this,e,t,r)},listeners:function(e){return C.list(this,e)},patch:function(e,t,r,n){return m.request(this,"PATCH",e,t,r,n)},post:function(e,t,r,n){return m.request(this,"POST",e,t,r,n)},put:function(e,t,r,n){return m.request(this,"PUT",e,t,r,n)},on:function(e,t,r,n,i){return C.add(this,e,t,r,n,i)},once:function(e,t,r,n,i){return C.add(this,e,t,r,n,i)},options:function(e,t){return m.request(this,"OPTIONS",e,t)},permissions:function(){return m.permissions(this)},singular:function(){return D.singular(this)},toCamelCase:function(){return D.toCamelCase(this)},toNumber:function(e){return N.parse(this,e)},trim:function(){return D.trim(this)},un:function(e,t,r){return C.remove(this,e,t,r)},uncapitalize:function(){return D.uncapitalize(this)},unhyphenate:function(e){return D.unhyphenate(this,e)}}},L.iterate(r[t],function(t,r){L.property(e.prototype,r,{value:t,configurable:!0,writable:!0})}),e},queryString:function(e,t){var r,n={},i=void 0!==t?t.indexOf("?")>-1?t.replace(/.*\?/,""):null:u||D.isEmpty(s.search)?null:s.search.replace("?","");return null===i||D.isEmpty(i)||(i=i.split("&"),p.each(i,function(e){r=e.split("="),D.isEmpty(r[0])||(void 0===r[1]||D.isEmpty(r[1])?r[1]="":D.isNumber(r[1])?r[1]=Number(r[1]):D.isBoolean(r[1])&&(r[1]="true"===r[1]),void 0===n[r[0]]?n[r[0]]=r[1]:n[r[0]]instanceof Array?n[r[0]].push(r[1]):(n[r[0]]=[n[r[0]]],n[r[0]].push(r[1])))})),null!==e&&void 0!==e&&(n=n[e]),n},reflect:function(e){return void 0===e&&(e=this||t),e=(""+e).match(h.reflect)[1],D.explode(e)},repeat:function(e,t,r,n){return t=t||10,r=r||L.uuid(!0),n=n!==!1,n&&e()===!1?void 0:(L.defer(function(){var n=function(e,t,r){var n=this;e()!==!1?L.repeating[r]=setTimeout(function(){n.call(n,e,t,r)},t):delete L.repeating[r]};n.call(n,e,t,r)},t,r),r)},script:function(e,r,n){return E.create("script",{type:"application/javascript",src:e},r||t("head")[0],n)},stylesheet:function(e,r){return E.create("link",{rel:"stylesheet",type:"text/css",href:e,media:r||"print, screen"},t("head")[0])},stop:function(e){return void 0!==e.cancelBubble&&(e.cancelBubble=!0),"function"==typeof e.preventDefault&&e.preventDefault(),"function"==typeof e.stopPropagation&&e.stopPropagation(),e.returnValue=!1,e},target:function(e){return e.target||e.srcElement},tpl:function(e,r){var n;if("object"!=typeof e||!h.object_undefined.test(typeof r)&&void 0===(r="#"===r.charAt(0)?t(r):t(r)[0]))throw Error(_.error.invalidArguments);return void 0===r&&(r=t("body")[0]),n=o.createDocumentFragment(),e instanceof Array?p.each(e,function(e){E.html(E.create(p.cast(e,!0)[0],n),p.cast(e)[0])}):L.iterate(e,function(e,t){"string"==typeof e?E.html(E.create(t,n),e):(e instanceof Array||e instanceof Object)&&L.tpl(e,E.create(t,n))}),r.appendChild(n),p.last(r.childNodes)},uuid:function(e){var t,r=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)},n=[8,9,"a","b"];return t=r()+r()+"-"+r()+"-4"+r().substr(0,3)+"-"+n[Math.floor(Math.random()*n.length)]+r().substr(0,3)+"-"+r()+r()+r(),e===!0&&(t=t.replace(/-/g,"")),t},walk:function(e,t){return p.each(t.replace(/\]$/,"").replace(/\]/g,".").split(/\.|\[/),function(t){e=e[t]}),e},when:function(){var e,t=0,r=O.factory(),n=p.cast(arguments);return n[0]instanceof Array&&(n=n[0]),e=n.length,0===e?r.resolve(null):p.each(n,function(i){i.then(function(){++t!==e||r.resolved()||(n.length>1?r.resolve(n.map(function(e){return e.outcome})):r.resolve(n[0].outcome))},function(){r.resolved()||(n.length>1?r.reject(n.map(function(e){return e.outcome})):r.reject(n[0].outcome))})}),r}},I={test:function(e){var r,n=!1,i=[],o=null,s=[];return void 0!==e.nodeName&&"FORM"===e.nodeName?(D.isEmpty(e.id)&&L.genId(e),s=t("#"+e.id+" input","#"+e.id+" select"),p.each(s,function(e){var t,r,o,s={};t=h[e.nodeName.toLowerCase()]?h[e.nodeName.toLowerCase()]:!D.isEmpty(e.id)&&h[e.id.toLowerCase()]?h[e.id.toLowerCase()]:"notEmpty",r=e.val(),null===r&&(r=""),s[t]=r,o=I.test(s),o.pass||(i.push({element:e,test:t,value:r}),n=!0)})):L.iterate(e,function(e,s){if(void 0===s||void 0===e)return i.push({test:s,value:e}),n=!0,void 0;switch(o="#"===(""+e).charAt(0)?void 0!==t(e)?t(e).val():"":e,s){case"date":isNaN(new Date(o).getYear())&&(i.push({test:s,value:o}),n=!0);break;case"domain":h.domain.test(o.replace(h.scheme,""))||(i.push({test:s,value:o}),n=!0);break;case"domainip":h.domain.test(o.replace(h.scheme,""))&&h.ip.test(o)||(i.push({test:s,value:o}),n=!0);break;default:r=h[s]||s,r.test(o)||(i.push({test:s,value:o}),n=!0)}}),{pass:!n,invalid:i}}},R=function(){var e,t,i,o,s,a=0,u=1,c=2,l=3,d=4,f=RegExp(c+"|"+l);return t={"User-Agent":"abaaso/3.7.1 node.js/"+process.versions.node.replace(/^v/,"")+" ("+D.capitalize(process.platform)+" V8/"+process.versions.v8+" )","Content-Type":"text/plain",Accept:"*/*"},s=function(e){return this.readyState!==e&&(this.readyState=e,this.dispatchEvent("readystatechange"),this.readyState!==d||this._error||(this.dispatchEvent("load"),this.dispatchEvent("loadend"))),this},i=function(e){var t=this;s.call(this,c),this.status=e.statusCode,this._resheaders=e.headers,void 0!==this._resheaders["set-cookie"]&&this._resheaders["set-cookie"]instanceof Array&&(this._resheaders["set-cookie"]=this._resheaders["set-cookie"].join(";")),e.on("data",function(r){e.setEncoding("utf8"),t._send&&(r&&(t.responseText+=r),s.call(t,l))}),e.on("end",function(){t._send&&(s.call(t,d),t._send=!1)}),e.on("close",function(e){o.call(t,e)})},o=function(e){this.status=503,this.statusText=e,this.responseText=void 0!==e?e.stack||e:e,this._error=!0,this.dispatchEvent("error"),s.call(this,d)},e=function(){this.onabort=null,this.onerror=null,this.onload=null,this.onloadend=null,this.onloadstart=null,this.onreadystatechange=null,this.readyState=a,this.response=null,this.responseText="",this.responseType="",this.responseXML=null,this.status=a,this.statusText="",this._id=L.genId(),this._error=!1,this._headers={},this._listeners={},this._params={},this._request=null,this._resheaders={},this._send=!1},e.prototype.abort=function(){return null!==this._request&&(this._request.abort(),this._request=null),this.responseText="",this.responseXML="",this._error=!0,this._headers={},(this._send===!0||f.test(this.readyState))&&(this._send=!1,s.call(this,d)),this.dispatchEvent("abort"),this.readyState=a,this},e.prototype.addEventListener=function(e,t){return this._listeners.hasOwnProperty(e)||(this._listeners[e]=[]),this._listeners[e].add(t),this},e.prototype.dispatchEvent=function(e){var t=this;return"function"==typeof this["on"+e]&&this["on"+e](),this._listeners.hasOwnProperty(e)&&p.each(this._listeners[e],function(e){"function"==typeof e&&e.call(t)}),this},e.prototype.getAllResponseHeaders=function(){var e="";if(c>this.readyState||this._error)throw Error(_.error.invalidStateNoHeaders);return L.iterate(this._resheaders,function(t,r){e+=r+": "+t+"\n"}),e},e.prototype.getResponseHeader=function(e){var t;if(c>this.readyState||this._error)throw Error(_.error.invalidStateNoHeaders);return t=this._resheaders[e]||this._resheaders[e.toLowerCase()]},e.prototype.open=function(e,r,n,i,o){var s=this;if(void 0!==n&&n!==!0)throw Error(_.error.invalidStateNoSync);return this.abort(),this._error=!1,this._params={method:e,url:r,async:n||!0,user:i||null,password:o||null},L.iterate(t,function(e,t){s._headers[t]=e}),this.readyState=u,this},e.prototype.overrideMimeType=function(e){return this._headers["Content-Type"]=e,this},e.prototype.removeEventListener=function(e,t){return this._listeners.hasOwnProperty(e)?(this._listeners[e].remove(t),this):void 0},e.prototype.send=function(e){e=e||null;var t,s,a,c,l=this;if(u>this.readyState)throw Error(_.error.invalidStateNotOpen);if(this._send)throw Error(_.error.invalidStateNotSending);return s=L.parse(this._params.url),s.port=s.port||("https:"===s.protocol?443:80),null!==this._params.user&&null!==this._params.password&&(s.auth=this._params.user+":"+this._params.password),h.put_post.test(this._params.method)&&(this._headers["Content-Length"]=null!==e?Buffer.byteLength(e):0),this._headers.Host=s.hostname+(h.http_ports.test(s.port)?"":":"+s.port),t={hostname:s.hostname,path:s.path,port:s.port,method:this._params.method,headers:this._headers},"https:"===s.protocol&&(t.rejectUnauthorized=!1,t.agent=!1),void 0!==s.auth&&(t.auth=s.auth),l._send=!0,l.dispatchEvent("readystatechange"),c="http:"===s.protocol?r:n,a=c.request(t,function(e){i.call(l,e)}).on("error",function(e){o.call(l,e)}),null===e?a.setSocketKeepAlive(!0,1e4):a.write(e,"utf8"),this._request=a,a.end(),l.dispatchEvent("loadstart"),this},e.prototype.setRequestHeader=function(e,t){if(this.readyState!==u)throw Error(_.error.invalidStateNotUsable);if(this._send)throw Error(_.error.invalidStateNotSending);return this._headers[e]=t,this},e},M={decode:function(e){try{var t;if("string"!=typeof e||D.isEmpty(e))throw Error(_.error.invalidArguments);return m.ie?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t
}catch(r){return l(r,arguments,this),void 0}},encode:function(e,t){try{if(void 0===e)throw Error(_.error.invalidArguments);t=!(t===!1);var r,n=t?"<xml>":"",i=!(arguments[2]===!1);return null!==e&&void 0!==e.xml&&(e=e.xml),e instanceof Document&&(e=(new XMLSerializer).serializeToString(e)),r=function(e,t){var r="<n>v</n>";return/\&|\<|\>|\"|\'|\t|\r|\n|\@|\$/g.test(t)&&(r=r.replace("v","<![CDATA[v]]>")),r.replace("n",e).replace("v",t)},h.boolean_number_string.test(typeof e)?n+=r("item",e):"object"==typeof e&&L.iterate(e,function(e,t){n+=M.encode(e,"object"==typeof e,!1).replace(/item|xml/g,isNaN(t)?t:"item")}),n+=t?"</xml>":"",i&&(n='<?xml version="1.0" encoding="UTF8"?>'+n),n}catch(o){return l(o,arguments,this),void 0}}};return l=L.error,c=function(){var r,n,i=this;if(delete abaaso.bootstrap,r=function(e){C.remove(e),p.each(p.cast(e.childNodes),function(e){r(e)})},n=function(){return h.complete_loaded.test(o.readyState)?("function"==typeof i.init&&i.init.call(i),!1):void 0},u)delete this.cookie,this.array.cast=p.cast(),this.property=L.property=L.property(),XMLHttpRequest=R();else{if(this.client.size=m.size(),this.client.version=m.version=m.version(),this.client.mobile=m.mobile.call(this),this.client.tablet=m.tablet.call(this),m.ie&&8>m.version)throw Error(_.error.upgrade);this.array.cast=p.cast(),this.mouse.view=j.view=j.view(),this.property=L.property=L.property(),void 0===Array.prototype.filter&&(Array.prototype.filter=function(e){if(void 0===this||null===this||"function"!=typeof e)throw Error(_.error.invalidArguments);var t=null,r=Object(this),n=r.length>>>0,i=[],o=arguments[1],s=null;for(t=0;n>t;t++)t in r&&(s=r[t],e.call(o,s,t,r)&&i.push(s));return i}),void 0===Array.prototype.forEach&&(Array.prototype.forEach=function(e,t){if(null===this||"function"!=typeof e)throw Error(_.error.invalidArguments);var r,n=0,i=Object(this),o=i.length>>>0;for(t&&(r=t);o>n;){var s;n in i&&(s=i[n],e.call(r,s,n,i)),n++}}),void 0===Array.prototype.indexOf&&(Array.prototype.indexOf=function(e,t){for(var r=t||0,n=this.length;n>r;r++)if(this[r]===e)return r;return-1}),void 0===Array.prototype.map&&(Array.prototype.map=function(e,t){var r,n,i;if(null==this)throw new TypeError("this is null or not defined");var o=Object(this),s=o.length>>>0;if("[object Function]"!={}.toString.call(e))throw new TypeError(e+" is not a function");for(t&&(r=t),n=Array(s),i=0;s>i;){var a,u;i in o&&(a=o[i],u=e.call(r,a,i,o),n[i]=u),i++}return n}),void 0===Array.prototype.reduce&&(Array.prototype.reduce=function(e){if(null===this||void 0===this)throw new TypeError("Object is null or undefined");var t,r=0,n=this.length>>0;if("function"!=typeof e)throw new TypeError("First argument is not callable");if(2>arguments.length){if(0===n)throw new TypeError("Array length is 0 and no second argument");t=this[0],r=1}else t=arguments[1];for(;n>r;)r in this&&(t=e.call(void 0,t,this[r],r,this)),++r;return t}),void 0===o.documentElement.classList&&function(e){var t,r,n,i,o;if("HTMLElement"in e||"Element"in e)if(t=function(e){var t=D.isEmpty(e.className)?[]:e.className.explode(" "),r=this;p.each(t,function(e){r.push(e)}),this.updateClassName=function(){e.className=this.join(" ")}},r=function(){return new t(this)},n=t.prototype=[],i=(e.HTMLElement||e.Element).prototype,n.add=function(e){p.contains(this,e)||(this.push(e),this.updateClassName())},n.contains=function(e){return p.contains(this,e)},n.remove=function(e){p.contains(this,e)&&(p.remove(this,e),this.updateClassName())},n.toggle=function(e){p[p.contains(this,e)?"remove":"add"](this,e),this.updateClassName()},Object.defineProperty)o={get:r,enumerable:!m.ie||m.version>8?!0:!1,configurable:!0},Object.defineProperty(i,"classList",o);else{if(!Object.prototype.__defineGetter__)throw Error("Could not create classList shim");i.__defineGetter__("classList",r)}}(e),void 0===Function.prototype.bind&&(Function.prototype.bind=function(e){var t=this,r=Array.prototype.slice,n=r.call(arguments,1);return function(){return t.apply(e,n.concat(r.call(arguments)))}})}switch(t=L.$,L.merge(t,this),delete t.$,delete t.bootstrap,delete t.init,delete t.loading,S.reset(),t.loading=this.loading.create.bind(t.loading),t.fire=this.fire,t.on=this.on,t.once=this.once,t.un=this.un,t.listeners=this.listeners,L.proto(Array,"array"),"undefined"!=typeof Element&&L.proto(Element,"element"),m.ie&&8===m.version&&L.proto(HTMLDocument,"element"),L.proto(Function,"function"),L.proto(Number,"number"),L.proto(String,"string"),t.error.log=this.error.log=[],u||(C.add(e,"error",function(e){C.fire(abaaso,"error",e)},"error",e,"all"),C.add(e,"hashchange",function(){var e=s.hash.replace(/\#|\!\/|\?.*/g,"");(t.route.current!==e||i.route.current!==e)&&(i.route.current=e,t.route.current!==i.route.current&&(t.route.current=i.route.current),C.fire(abaaso,"beforeHash, hash, afterHash",s.hash))},"hash",e,"all"),C.add(e,"resize",function(){t.client.size=i.client.size=m.size(),C.fire(abaaso,"resize",i.client.size)},"resize",e,"all"),C.add(e,"load",function(){C.fire(abaaso,"render"),C.remove(abaaso,"render"),C.remove(this,"load")}),"function"==typeof Object.observe&&C.add(e,"DOMNodeInserted",function(e){var t=L.target(e);Object.observe(t,function(e){C.fire(t,"change",e)})},"mutation",e,"all"),C.add(e,"DOMNodeRemoved",function(e){var t=L.target(e);void 0!==t.id&&!D.isEmpty(t.id)&&e.relatedNode instanceof Element&&r(t)},"mutation",e,"all"),C.add(abaaso,"hash",function(e){(t.route.enabled||i.route.enabled)&&S.load(e)},"route",this.route,"all")),!m.ie||m.version>8?(L.property(this.state,"current",{enumerable:!0,get:T.getCurrent,set:T.setCurrent}),L.property(this.state,"previous",{enumerable:!0,get:T.getPrevious,set:T.setPrevious}),L.property(this.state,"header",{enumerable:!0,get:T.getHeader,set:T.setHeader}),L.property(t.state,"current",{enumerable:!0,get:T.getCurrent,set:T.setCurrent}),L.property(t.state,"previous",{enumerable:!0,get:T.getPrevious,set:T.setPrevious}),L.property(t.state,"header",{enumerable:!0,get:T.getHeader,set:T.setHeader})):(t.state.current=i.state.current=i.state._current,t.state.change=this.state.change=function(e){return i.state.current=T.setCurrent(e)},t.state.setHeader=this.state.setHeader=function(e){return i.state.header=T.setHeader(e)}),t.ready=!0,!0){case"undefined"!=typeof exports:case"function"==typeof define:this.init();break;case h.complete_loaded.test(o.readyState):this.init();break;case"function"==typeof o.addEventListener:o.addEventListener("DOMContentLoaded",function(){i.init.call(i)},!1);break;case"function"==typeof o.attachEvent:o.attachEvent("onreadystatechange",n);break;default:L.repeat(n)}return t},{array:p,callback:{},client:{activex:m.activex,android:m.android,blackberry:m.blackberry,chrome:m.chrome,firefox:m.firefox,ie:m.ie,ios:m.ios,linux:m.linux,mobile:m.mobile,opera:m.opera,osx:m.osx,playbook:m.playbook,safari:m.safari,tablet:m.tablet,size:{height:0,width:0},version:0,webos:m.webos,windows:m.windows,del:function(e,t,r,n,i){return m.request(e,"DELETE",t,r,null,n,i)},get:function(e,t,r,n,i){return m.request(e,"GET",t,r,null,n,i)},headers:function(e,t,r,n){return m.request(e,"HEAD",t,r,null,null,n)},patch:function(e,t,r,n,i,o){return m.request(e,"PATCH",t,r,n,i,o)},post:function(e,t,r,n,i,o){return m.request(e,"POST",t,r,n,i,o)},put:function(e,t,r,n,i,o){return m.request(e,"PUT",t,r,n,i,o)},jsonp:function(e,t,r,n){return m.jsonp(e,t,r,n)},options:function(e,t,r,n){return m.request(e,"OPTIONS",t,r,null,null,n)},permissions:m.permissions},cookie:y,element:E,json:k,label:_,loading:{create:L.loading,url:null},message:A,mouse:j,number:N,regex:h,route:{enabled:!1,current:S.current,del:S.del,hash:S.hash,init:S.init,initial:S.initial,list:S.list,load:S.load,reset:S.reset,server:S.server,set:S.set},state:{},string:D,xml:M,$:L.$,alias:L.alias,aliased:"abaaso",allows:m.allows,append:function(e,t,r){return r instanceof Element&&r.genId(),E.create(e,t,r,"last")},bootstrap:c,clear:E.clear,clearTimer:L.clearTimers,clone:L.clone,coerce:L.coerce,compile:L.compile,create:E.create,css:L.css,data:g.decorator,datalist:b.factory,discard:function(e){return C.discard(e)},debounce:L.debounce,decode:k.decode,defer:w.factory,define:L.define,del:function(e,t,r,n,i){return m.request(e,"DELETE",t,r,null,n,i)},delay:L.defer,destroy:E.destroy,encode:k.encode,error:L.error,expire:v.clean,expires:12e4,extend:L.extend,filter:x.factory,fire:function(e,r){var n="object"==typeof e,i=n?e:this!==t?this:abaaso,o=n?r:e,s=[i,o].concat(p.cast(arguments).remove(0,n?1:0));return C.fire.apply(C,s)},genId:L.genId,get:function(e,t,r,n,i){return m.request(e,"GET",t,r,null,n,i)},guid:function(){return L.uuid().toUpperCase()},hash:S.hash,headers:function(e,t,r,n){return m.request(e,"HEAD",t,r,null,{},n)},hex:L.hex,hidden:E.hidden,hook:C.decorate,id:"abaaso",init:function(){return delete abaaso.init,C.fire(this,"init, ready").un(this,"init, ready")},iterate:L.iterate,jsonp:function(e,t,r,n){return m.jsonp(e,t,r,n)},listeners:function(e,r){return e="object"==typeof e?e:this!==t?this:abaaso,C.list(e,r)},listenersTotal:C.sum,log:L.log,logging:C.log,merge:L.merge,module:L.module,object:L.object,observerable:C.decorate,on:function(e,r,n,i,o,s){var a,u,c,l,d,f,h="object"==typeof e;return h?(a=e,u=r,c=n,l=i,d=o,f=s):(a=this!==t?this:abaaso,u=e,c=r,l=n,d=i,f=o),void 0===d&&(d=a),C.add(a,u,c,l,d,f)},once:function(e,r,n,i,o,s){var a,u,c,l,d,f,h="object"==typeof e;return h?(a=e,u=r,c=n,l=i,d=o,f=s):(a=this!==t?this:abaaso,u=e,c=r,l=n,d=i,f=o),void 0===d&&(d=a),C.once(a,u,c,l,d,f)},options:function(e,t,r,n){return m.request(e,"OPTIONS",t,r,null,null,n)},parse:L.parse,patch:function(e,t,r,n,i,o){return m.request(e,"PATCH",t,r,n,i,o)},pause:function(e){return C.pause(e!==!1)},permissions:m.permissions,position:E.position,post:function(e,t,r,n,i,o){return m.request(e,"POST",t,r,n,i,o)},prepend:function(e,t,r){return r instanceof Element&&r.genId(),E.create(e,t,r,"first")},promise:O.factory,property:L.property,put:function(e,t,r,n,i,o){return m.request(e,"PUT",t,r,n,i,o)},queryString:function(e,t){return L.queryString(e,t)},random:N.random,ready:!1,reflect:L.reflect,repeat:L.repeat,stylesheet:L.stylesheet,script:L.script,stop:L.stop,store:g.decorator,target:L.target,tpl:L.tpl,un:function(e,r,n,i){var o,s,a,u,c="object"==typeof e;return c?(o=e,s=r,a=n,u=i):(o=this!==t?this:abaaso,s=e,a=r,u=n),C.remove(o,s,a,u)},update:E.update,uuid:L.uuid,validate:I.test,version:"3.7.1",walk:L.walk,when:L.when}}(),t=abaaso.bootstrap(),"undefined"!=typeof exports?module.exports=t:"function"==typeof define?define("abaaso",function(){return t}):e.abaaso=t)})(this);
//@ sourceMappingURL=abaaso.source-map.js